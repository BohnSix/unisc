[2025-10-21 16:28:58 default] (main.py 589): INFO Full config saved to output/eval/config.json
[2025-10-21 16:28:58 default] (main.py 595): INFO Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3: NVIDIA GeForce RTX 4090
CUDA_HOME: /usr/local/cuda-11.8
NVCC: Cuda compilation tools, release 11.8, V11.8.89
GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
PyTorch: 1.13.1+cu117
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

TorchVision: 0.14.1+cu117
OpenCV: 4.6.0
MMCV: 1.6.2
MMCV Compiler: GCC 9.4
MMCV CUDA Compiler: 11.8
------------------------------------------------------------

[2025-10-21 16:28:58 default] (main.py 597): INFO Git hash: ef51a59
[2025-10-21 16:28:58 default] (main.py 600): INFO evaluate:
  pamr: false
  bg_thresh: 0.4
  kp_w: 0.3
  pred_qual_path: null
  gt_qual_path: null
  eval_only: true
  template: sub_imagenet_template
  task:
  - cityscapes
  t_voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_voc12_20.py
  t_context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_context59.py
  voc: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12.py
  voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12_20.py
  context: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context.py
  context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context59.py
  coco_stuff: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/stuff.py
  coco_object: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/coco.py
  cityscapes: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/cityscapes.py
  ade20k: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/ade20k.py
  save_logits: null
  eval_freq: 5000
_base_: default.yml
data:
  batch_size: 256
  pin_memory: true
  num_workers: 0
  seed: ${train.seed}
  dataset:
    meta:
      gcc3m:
        type: img_txt_pair
        path: ./data/gcc3m
        prefix: gcc-train-{000000..00347}.tar
        length: 2881393
      gcc12m:
        type: img_txt_pair
        path: ./data/gcc12m
        prefix: cc-{000000..001175}.tar
        length: 11286526
    train:
    - gcc3m
    - gcc12m
  img_aug:
    deit_aug: true
    img_size: 224
    img_scale:
    - 0.08
    - 1.0
    interpolation: bilinear
    color_jitter: 0.4
    auto_augment: rand-m9-mstd0.5-inc1
    re_prob: 0.25
    re_mode: pixel
    re_count: 1
  text_aug: null
train:
  start_step: 0
  total_steps: 50000
  warmup_steps: 20000
  ust_steps: 0
  base_lr: 0.0016
  weight_decay: 0.05
  min_lr: 4.0e-05
  clip_grad: 5.0
  fp16: true
  fp16_comm: true
  seed: 42
  lr_scheduler:
    name: cosine
  optimizer:
    name: adamw
    eps: 1.0e-08
    betas:
    - 0.9
    - 0.999
checkpoint:
  resume: ''
  save_topk: 0
  save_all: false
model_name: default
output: output/eval
tag: default
print_freq: 20
seed: 42
wandb: false
model:
  clip_model_name: ViT-B/16
  keep_cls: false
  keep_end_seq: false
  model_name: dinov2_vitb14_reg
  proj_model: DINOJSCC_Adapter
  proj_name: vitb_jscc_infonce
  proj_class: vitb_jscc_infonce
  resize_dim: 518
  type: DINOJSCC
  use_avg_text_token: false
  k: 12
  text_adapter_pretrain: weights/vitb_mlp_infonce.pth

[2025-10-21 16:28:59 default] (main.py 202): INFO Creating model:DINOJSCC/default
[2025-10-21 16:32:27 default] (main.py 589): INFO Full config saved to output/eval/config.json
[2025-10-21 16:32:27 default] (main.py 595): INFO Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3: NVIDIA GeForce RTX 4090
CUDA_HOME: /usr/local/cuda-11.8
NVCC: Cuda compilation tools, release 11.8, V11.8.89
GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
PyTorch: 1.13.1+cu117
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

TorchVision: 0.14.1+cu117
OpenCV: 4.6.0
MMCV: 1.6.2
MMCV Compiler: GCC 9.4
MMCV CUDA Compiler: 11.8
------------------------------------------------------------

[2025-10-21 16:32:27 default] (main.py 597): INFO Git hash: ef51a59
[2025-10-21 16:32:27 default] (main.py 600): INFO evaluate:
  pamr: false
  bg_thresh: 0.4
  kp_w: 0.3
  pred_qual_path: null
  gt_qual_path: null
  eval_only: true
  template: sub_imagenet_template
  task:
  - cityscapes
  t_voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_voc12_20.py
  t_context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_context59.py
  voc: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12.py
  voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12_20.py
  context: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context.py
  context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context59.py
  coco_stuff: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/stuff.py
  coco_object: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/coco.py
  cityscapes: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/cityscapes.py
  ade20k: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/ade20k.py
  save_logits: null
  eval_freq: 5000
_base_: default.yml
data:
  batch_size: 256
  pin_memory: true
  num_workers: 0
  seed: ${train.seed}
  dataset:
    meta:
      gcc3m:
        type: img_txt_pair
        path: ./data/gcc3m
        prefix: gcc-train-{000000..00347}.tar
        length: 2881393
      gcc12m:
        type: img_txt_pair
        path: ./data/gcc12m
        prefix: cc-{000000..001175}.tar
        length: 11286526
    train:
    - gcc3m
    - gcc12m
  img_aug:
    deit_aug: true
    img_size: 224
    img_scale:
    - 0.08
    - 1.0
    interpolation: bilinear
    color_jitter: 0.4
    auto_augment: rand-m9-mstd0.5-inc1
    re_prob: 0.25
    re_mode: pixel
    re_count: 1
  text_aug: null
train:
  start_step: 0
  total_steps: 50000
  warmup_steps: 20000
  ust_steps: 0
  base_lr: 0.0016
  weight_decay: 0.05
  min_lr: 4.0e-05
  clip_grad: 5.0
  fp16: true
  fp16_comm: true
  seed: 42
  lr_scheduler:
    name: cosine
  optimizer:
    name: adamw
    eps: 1.0e-08
    betas:
    - 0.9
    - 0.999
checkpoint:
  resume: ''
  save_topk: 0
  save_all: false
model_name: default
output: output/eval
tag: default
print_freq: 20
seed: 42
wandb: false
model:
  clip_model_name: ViT-B/16
  keep_cls: false
  keep_end_seq: false
  model_name: dinov2_vitb14_reg
  proj_model: DINOJSCC_Adapter
  proj_name: vitb_jscc_infonce
  proj_class: vitb_jscc_infonce
  resize_dim: 518
  type: DINOJSCC
  use_avg_text_token: false
  k: 12
  text_adapter_pretrain: weights/vitb_mlp_infonce.pth

[2025-10-21 16:32:27 default] (main.py 202): INFO Creating model:DINOJSCC/default
[2025-10-21 16:32:33 default] (main.py 221): INFO number of params: 611521 (0.6M)
[2025-10-21 16:32:33 default] (main.py 225): INFO GROUP_RANK = 0 | LOCAL_RANK = 0 | RANK = 0 | MASTER_ADDR = 127.0.0.1 | MASTER_PORT = 29500 | ROLE_RANK = 0 | LOCAL_WORLD_SIZE = 1 | WORLD_SIZE = 1 | ROLE_WORLD_SIZE = 1 | TORCHELASTIC_RESTART_COUNT = 0 | TORCHELASTIC_MAX_RESTARTS = 0 | TORCHELASTIC_RUN_ID = none
[2025-10-21 16:32:33 default] (main.py 232): INFO !!! Single-node setting :: skip fp16 compression hook
[2025-10-21 16:32:33 default] (main.py 450): INFO ### Validation dataset: cityscapes (Subset)
[2025-10-21 16:32:34 default] (dinotext_seg.py 43): INFO Building DINOTextSegInference with 19 classes, test_cfg=Config (path: None): {'mode': 'slide', 'stride': (224, 224), 'crop_size': (448, 448)}, with_bg=False, pamr=False, bg_thresh=0.4
[2025-10-21 16:36:52 default] (logging.py 102): INFO per class results:
[2025-10-21 16:36:52 default] (logging.py 102): INFO 
+---------------+-------+-------+
|     Class     |  IoU  |  Acc  |
+---------------+-------+-------+
|      road     |  5.93 |  6.0  |
|    sidewalk   | 11.23 | 97.24 |
|    building   | 59.73 | 72.25 |
|      wall     |  3.45 |  17.1 |
|     fence     |  22.6 | 30.42 |
|      pole     |  0.99 |  1.01 |
| traffic light | 11.04 | 78.51 |
|  traffic sign |  34.3 | 61.25 |
|   vegetation  |  1.8  |  1.8  |
|    terrain    |  0.91 |  2.51 |
|      sky      | 21.01 | 82.87 |
|     person    | 30.74 | 35.55 |
|     rider     | 13.62 | 59.62 |
|      car      | 60.15 | 64.43 |
|     truck     | 12.17 | 55.38 |
|      bus      | 26.64 | 87.16 |
|     train     |  1.19 |  1.31 |
|   motorcycle  |  8.79 | 88.01 |
|    bicycle    | 26.46 | 32.67 |
+---------------+-------+-------+
[2025-10-21 16:36:52 default] (logging.py 102): INFO Summary:
[2025-10-21 16:36:52 default] (logging.py 102): INFO 
+-------+-------+-------+
|  aAcc |  mIoU |  mAcc |
+-------+-------+-------+
| 33.01 | 18.57 | 46.06 |
+-------+-------+-------+
[2025-10-21 16:36:52 default] (main.py 454): INFO [cityscapes] mIoU of 500 test images: 18.57%
[2025-10-21 16:36:52 default] (main.py 241): INFO {'val/cityscapes_miou': 18.57, 'metrics': [{'aAcc': 0.3301, 'mIoU': 0.1857, 'mAcc': 0.4606, 'IoU.road': 0.05929999828338623, 'IoU.sidewalk': 0.11229999542236328, 'IoU.building': 0.5972999954223632, 'IoU.wall': 0.034500000476837156, 'IoU.fence': 0.22600000381469726, 'IoU.pole': 0.009900000095367432, 'IoU.traffic light': 0.11039999961853027, 'IoU.traffic sign': 0.34299999237060547, 'IoU.vegetation': 0.017999999523162842, 'IoU.terrain': 0.009100000262260438, 'IoU.sky': 0.21010000228881837, 'IoU.person': 0.30739999771118165, 'IoU.rider': 0.1361999988555908, 'IoU.car': 0.601500015258789, 'IoU.truck': 0.12170000076293945, 'IoU.bus': 0.2663999938964844, 'IoU.train': 0.01190000057220459, 'IoU.motorcycle': 0.08789999961853028, 'IoU.bicycle': 0.2645999908447266, 'Acc.road': 0.06, 'Acc.sidewalk': 0.9723999786376953, 'Acc.building': 0.7225, 'Acc.wall': 0.17100000381469727, 'Acc.fence': 0.30420000076293946, 'Acc.pole': 0.010099999904632569, 'Acc.traffic light': 0.7851000213623047, 'Acc.traffic sign': 0.6125, 'Acc.vegetation': 0.017999999523162842, 'Acc.terrain': 0.025099999904632568, 'Acc.sky': 0.8287000274658203, 'Acc.person': 0.3554999923706055, 'Acc.rider': 0.5961999893188477, 'Acc.car': 0.6443000030517578, 'Acc.truck': 0.5538000106811524, 'Acc.bus': 0.8716000366210938, 'Acc.train': 0.01309999942779541, 'Acc.motorcycle': 0.8801000213623047, 'Acc.bicycle': 0.32669998168945313}], 'val/avg_miou': 18.57}
[2025-10-21 16:36:52 default] (main.py 245): INFO  >> 18.57, 18.57
[2025-10-21 16:36:52 default] (main.py 246): INFO Experiment dir: output/eval
[2025-10-21 16:36:52 default] (main.py 145): INFO Saved results at segmentation_results/vitb_jscc_infonce.json
[2025-10-21 16:36:52 default] (main.py 607): INFO Experiment dir: output/eval
[2025-10-21 16:39:17 default] (main.py 589): INFO Full config saved to output/eval/config.json
[2025-10-21 16:39:17 default] (main.py 595): INFO Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3: NVIDIA GeForce RTX 4090
CUDA_HOME: /usr/local/cuda-11.8
NVCC: Cuda compilation tools, release 11.8, V11.8.89
GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
PyTorch: 1.13.1+cu117
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

TorchVision: 0.14.1+cu117
OpenCV: 4.6.0
MMCV: 1.6.2
MMCV Compiler: GCC 9.4
MMCV CUDA Compiler: 11.8
------------------------------------------------------------

[2025-10-21 16:39:17 default] (main.py 597): INFO Git hash: ef51a59
[2025-10-21 16:39:17 default] (main.py 600): INFO evaluate:
  pamr: false
  bg_thresh: 0.4
  kp_w: 0.3
  pred_qual_path: null
  gt_qual_path: null
  eval_only: true
  template: sub_imagenet_template
  task:
  - cityscapes
  t_voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_voc12_20.py
  t_context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_context59.py
  voc: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12.py
  voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12_20.py
  context: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context.py
  context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context59.py
  coco_stuff: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/stuff.py
  coco_object: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/coco.py
  cityscapes: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/cityscapes.py
  ade20k: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/ade20k.py
  save_logits: null
  eval_freq: 5000
_base_: default.yml
data:
  batch_size: 256
  pin_memory: true
  num_workers: 0
  seed: ${train.seed}
  dataset:
    meta:
      gcc3m:
        type: img_txt_pair
        path: ./data/gcc3m
        prefix: gcc-train-{000000..00347}.tar
        length: 2881393
      gcc12m:
        type: img_txt_pair
        path: ./data/gcc12m
        prefix: cc-{000000..001175}.tar
        length: 11286526
    train:
    - gcc3m
    - gcc12m
  img_aug:
    deit_aug: true
    img_size: 224
    img_scale:
    - 0.08
    - 1.0
    interpolation: bilinear
    color_jitter: 0.4
    auto_augment: rand-m9-mstd0.5-inc1
    re_prob: 0.25
    re_mode: pixel
    re_count: 1
  text_aug: null
train:
  start_step: 0
  total_steps: 50000
  warmup_steps: 20000
  ust_steps: 0
  base_lr: 0.0016
  weight_decay: 0.05
  min_lr: 4.0e-05
  clip_grad: 5.0
  fp16: true
  fp16_comm: true
  seed: 42
  lr_scheduler:
    name: cosine
  optimizer:
    name: adamw
    eps: 1.0e-08
    betas:
    - 0.9
    - 0.999
checkpoint:
  resume: ''
  save_topk: 0
  save_all: false
model_name: default
output: output/eval
tag: default
print_freq: 20
seed: 42
wandb: false
model:
  clip_model_name: ViT-B/16
  keep_cls: false
  keep_end_seq: false
  model_name: dinov2_vitb14_reg
  proj_model: DINOJSCC_Adapter
  proj_name: vitb_jscc_infonce
  proj_class: vitb_jscc_infonce
  resize_dim: 518
  type: DINOJSCC
  use_avg_text_token: false
  k: 24
  text_adapter_pretrain: weights/vitb_mlp_infonce.pth

[2025-10-21 16:39:17 default] (main.py 202): INFO Creating model:DINOJSCC/default
[2025-10-21 16:39:22 default] (main.py 221): INFO number of params: 630433 (0.6M)
[2025-10-21 16:39:22 default] (main.py 225): INFO GROUP_RANK = 0 | LOCAL_RANK = 0 | RANK = 0 | MASTER_ADDR = 127.0.0.1 | MASTER_PORT = 29500 | ROLE_RANK = 0 | LOCAL_WORLD_SIZE = 1 | WORLD_SIZE = 1 | ROLE_WORLD_SIZE = 1 | TORCHELASTIC_RESTART_COUNT = 0 | TORCHELASTIC_MAX_RESTARTS = 0 | TORCHELASTIC_RUN_ID = none
[2025-10-21 16:39:22 default] (main.py 232): INFO !!! Single-node setting :: skip fp16 compression hook
[2025-10-21 16:39:22 default] (main.py 450): INFO ### Validation dataset: cityscapes (Subset)
[2025-10-21 16:39:23 default] (dinotext_seg.py 43): INFO Building DINOTextSegInference with 19 classes, test_cfg=Config (path: None): {'mode': 'slide', 'stride': (224, 224), 'crop_size': (448, 448)}, with_bg=False, pamr=False, bg_thresh=0.4
[2025-10-21 16:41:27 default] (logging.py 102): INFO per class results:
[2025-10-21 16:41:27 default] (logging.py 102): INFO 
+---------------+-------+-------+
|     Class     |  IoU  |  Acc  |
+---------------+-------+-------+
|      road     | 11.32 | 11.53 |
|    sidewalk   | 12.14 | 96.64 |
|    building   | 61.36 |  74.2 |
|      wall     |  5.67 | 28.22 |
|     fence     | 30.41 | 38.07 |
|      pole     |  2.95 |  3.13 |
| traffic light |  8.27 | 86.39 |
|  traffic sign | 30.08 | 51.04 |
|   vegetation  |  1.7  |  1.7  |
|    terrain    |  1.04 |  3.21 |
|      sky      | 21.04 | 83.17 |
|     person    | 32.64 | 37.43 |
|     rider     | 13.71 | 60.68 |
|      car      | 71.16 | 76.47 |
|     truck     | 30.12 |  59.0 |
|      bus      | 26.18 |  90.9 |
|     train     |  0.63 |  0.68 |
|   motorcycle  | 19.06 | 88.73 |
|    bicycle    | 46.98 |  63.8 |
+---------------+-------+-------+
[2025-10-21 16:41:27 default] (logging.py 102): INFO Summary:
[2025-10-21 16:41:27 default] (logging.py 102): INFO 
+-------+-------+-------+
|  aAcc |  mIoU |  mAcc |
+-------+-------+-------+
| 36.67 | 22.45 | 50.26 |
+-------+-------+-------+
[2025-10-21 16:41:27 default] (main.py 454): INFO [cityscapes] mIoU of 500 test images: 22.45%
[2025-10-21 16:41:27 default] (main.py 241): INFO {'val/cityscapes_miou': 22.45, 'metrics': [{'aAcc': 0.3667, 'mIoU': 0.2245, 'mAcc': 0.5025999999999999, 'IoU.road': 0.11319999694824219, 'IoU.sidewalk': 0.12140000343322754, 'IoU.building': 0.6136000061035156, 'IoU.wall': 0.056700000762939455, 'IoU.fence': 0.3040999984741211, 'IoU.pole': 0.02950000047683716, 'IoU.traffic light': 0.08270000457763672, 'IoU.traffic sign': 0.3007999992370605, 'IoU.vegetation': 0.017000000476837158, 'IoU.terrain': 0.010399999618530274, 'IoU.sky': 0.21040000915527343, 'IoU.person': 0.3263999938964844, 'IoU.rider': 0.13710000038146972, 'IoU.car': 0.7116000366210937, 'IoU.truck': 0.30120000839233396, 'IoU.bus': 0.2618000030517578, 'IoU.train': 0.0062999999523162846, 'IoU.motorcycle': 0.19059999465942382, 'IoU.bicycle': 0.4697999954223633, 'Acc.road': 0.11529999732971191, 'Acc.sidewalk': 0.9663999938964843, 'Acc.building': 0.7419999694824219, 'Acc.wall': 0.28219999313354494, 'Acc.fence': 0.3806999969482422, 'Acc.pole': 0.03130000114440918, 'Acc.traffic light': 0.8638999938964844, 'Acc.traffic sign': 0.5104000091552734, 'Acc.vegetation': 0.017000000476837158, 'Acc.terrain': 0.03210000038146973, 'Acc.sky': 0.8316999816894531, 'Acc.person': 0.3743000030517578, 'Acc.rider': 0.6068000030517579, 'Acc.car': 0.7647000122070312, 'Acc.truck': 0.59, 'Acc.bus': 0.909000015258789, 'Acc.train': 0.006800000071525574, 'Acc.motorcycle': 0.887300033569336, 'Acc.bicycle': 0.6379999923706055}], 'val/avg_miou': 22.45}
[2025-10-21 16:41:27 default] (main.py 245): INFO  >> 22.45, 22.45
[2025-10-21 16:41:27 default] (main.py 246): INFO Experiment dir: output/eval
[2025-10-21 16:41:27 default] (main.py 145): INFO Saved results at segmentation_results/vitb_jscc_infonce.json
[2025-10-21 16:41:27 default] (main.py 607): INFO Experiment dir: output/eval
[2025-10-21 16:43:03 default] (main.py 589): INFO Full config saved to output/eval/config.json
[2025-10-21 16:43:03 default] (main.py 595): INFO Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3: NVIDIA GeForce RTX 4090
CUDA_HOME: /usr/local/cuda-11.8
NVCC: Cuda compilation tools, release 11.8, V11.8.89
GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
PyTorch: 1.13.1+cu117
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

TorchVision: 0.14.1+cu117
OpenCV: 4.6.0
MMCV: 1.6.2
MMCV Compiler: GCC 9.4
MMCV CUDA Compiler: 11.8
------------------------------------------------------------

[2025-10-21 16:43:03 default] (main.py 597): INFO Git hash: ef51a59
[2025-10-21 16:43:03 default] (main.py 600): INFO evaluate:
  pamr: false
  bg_thresh: 0.4
  kp_w: 0.3
  pred_qual_path: null
  gt_qual_path: null
  eval_only: true
  template: sub_imagenet_template
  task:
  - cityscapes
  t_voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_voc12_20.py
  t_context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_context59.py
  voc: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12.py
  voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12_20.py
  context: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context.py
  context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context59.py
  coco_stuff: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/stuff.py
  coco_object: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/coco.py
  cityscapes: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/cityscapes.py
  ade20k: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/ade20k.py
  save_logits: null
  eval_freq: 5000
_base_: default.yml
data:
  batch_size: 256
  pin_memory: true
  num_workers: 0
  seed: ${train.seed}
  dataset:
    meta:
      gcc3m:
        type: img_txt_pair
        path: ./data/gcc3m
        prefix: gcc-train-{000000..00347}.tar
        length: 2881393
      gcc12m:
        type: img_txt_pair
        path: ./data/gcc12m
        prefix: cc-{000000..001175}.tar
        length: 11286526
    train:
    - gcc3m
    - gcc12m
  img_aug:
    deit_aug: true
    img_size: 224
    img_scale:
    - 0.08
    - 1.0
    interpolation: bilinear
    color_jitter: 0.4
    auto_augment: rand-m9-mstd0.5-inc1
    re_prob: 0.25
    re_mode: pixel
    re_count: 1
  text_aug: null
train:
  start_step: 0
  total_steps: 50000
  warmup_steps: 20000
  ust_steps: 0
  base_lr: 0.0016
  weight_decay: 0.05
  min_lr: 4.0e-05
  clip_grad: 5.0
  fp16: true
  fp16_comm: true
  seed: 42
  lr_scheduler:
    name: cosine
  optimizer:
    name: adamw
    eps: 1.0e-08
    betas:
    - 0.9
    - 0.999
checkpoint:
  resume: ''
  save_topk: 0
  save_all: false
model_name: default
output: output/eval
tag: default
print_freq: 20
seed: 42
wandb: false
model:
  clip_model_name: ViT-B/16
  keep_cls: false
  keep_end_seq: false
  model_name: dinov2_vitb14_reg
  proj_model: DINOJSCC_Adapter
  proj_name: vitb_jscc_infonce
  proj_class: vitb_jscc_infonce
  resize_dim: 518
  type: DINOJSCC
  use_avg_text_token: false
  k: 36
  text_adapter_pretrain: weights/vitb_mlp_infonce.pth

[2025-10-21 16:43:03 default] (main.py 202): INFO Creating model:DINOJSCC/default
[2025-10-21 16:43:08 default] (main.py 221): INFO number of params: 649633 (0.6M)
[2025-10-21 16:43:08 default] (main.py 225): INFO GROUP_RANK = 0 | LOCAL_RANK = 0 | RANK = 0 | MASTER_ADDR = 127.0.0.1 | MASTER_PORT = 29500 | ROLE_RANK = 0 | LOCAL_WORLD_SIZE = 1 | WORLD_SIZE = 1 | ROLE_WORLD_SIZE = 1 | TORCHELASTIC_RESTART_COUNT = 0 | TORCHELASTIC_MAX_RESTARTS = 0 | TORCHELASTIC_RUN_ID = none
[2025-10-21 16:43:08 default] (main.py 232): INFO !!! Single-node setting :: skip fp16 compression hook
[2025-10-21 16:43:08 default] (main.py 450): INFO ### Validation dataset: cityscapes (Subset)
[2025-10-21 16:43:09 default] (dinotext_seg.py 43): INFO Building DINOTextSegInference with 19 classes, test_cfg=Config (path: None): {'mode': 'slide', 'stride': (224, 224), 'crop_size': (448, 448)}, with_bg=False, pamr=False, bg_thresh=0.4
[2025-10-21 16:44:54 default] (logging.py 102): INFO per class results:
[2025-10-21 16:44:54 default] (logging.py 102): INFO 
+---------------+-------+-------+
|     Class     |  IoU  |  Acc  |
+---------------+-------+-------+
|      road     | 14.47 | 14.85 |
|    sidewalk   | 12.31 | 97.51 |
|    building   | 60.01 | 71.25 |
|      wall     |  5.19 | 25.98 |
|     fence     |  31.1 | 38.53 |
|      pole     |  5.69 |  6.29 |
| traffic light |  9.26 | 87.98 |
|  traffic sign |  29.3 | 60.15 |
|   vegetation  |  2.02 |  2.02 |
|    terrain    |  1.0  |  3.0  |
|      sky      | 21.37 | 83.95 |
|     person    | 34.68 | 40.18 |
|     rider     | 16.34 |  63.0 |
|      car      | 69.65 | 74.82 |
|     truck     | 32.81 | 66.55 |
|      bus      | 29.29 | 88.89 |
|     train     |  0.08 |  0.09 |
|   motorcycle  |  24.0 |  84.6 |
|    bicycle    | 49.49 | 66.84 |
+---------------+-------+-------+
[2025-10-21 16:44:54 default] (logging.py 102): INFO Summary:
[2025-10-21 16:44:54 default] (logging.py 102): INFO 
+-------+-------+-------+
|  aAcc |  mIoU |  mAcc |
+-------+-------+-------+
| 37.46 | 23.58 | 51.39 |
+-------+-------+-------+
[2025-10-21 16:44:54 default] (main.py 454): INFO [cityscapes] mIoU of 500 test images: 23.58%
[2025-10-21 16:44:54 default] (main.py 241): INFO {'val/cityscapes_miou': 23.58, 'metrics': [{'aAcc': 0.3746, 'mIoU': 0.23579999999999998, 'mAcc': 0.5139, 'IoU.road': 0.1447000026702881, 'IoU.sidewalk': 0.123100004196167, 'IoU.building': 0.600099983215332, 'IoU.wall': 0.05190000057220459, 'IoU.fence': 0.3110000038146973, 'IoU.pole': 0.05690000057220459, 'IoU.traffic light': 0.09260000228881836, 'IoU.traffic sign': 0.2929999923706055, 'IoU.vegetation': 0.020199999809265137, 'IoU.terrain': 0.01, 'IoU.sky': 0.213700008392334, 'IoU.person': 0.3468000030517578, 'IoU.rider': 0.1634000015258789, 'IoU.car': 0.696500015258789, 'IoU.truck': 0.32810001373291015, 'IoU.bus': 0.2929000091552734, 'IoU.train': 0.0007999999821186065, 'IoU.motorcycle': 0.24, 'IoU.bicycle': 0.494900016784668, 'Acc.road': 0.14850000381469727, 'Acc.sidewalk': 0.9751000213623047, 'Acc.building': 0.7125, 'Acc.wall': 0.25979999542236326, 'Acc.fence': 0.38529998779296876, 'Acc.pole': 0.06289999961853027, 'Acc.traffic light': 0.8798000335693359, 'Acc.traffic sign': 0.601500015258789, 'Acc.vegetation': 0.020199999809265137, 'Acc.terrain': 0.03, 'Acc.sky': 0.8394999694824219, 'Acc.person': 0.40180000305175784, 'Acc.rider': 0.63, 'Acc.car': 0.7481999969482422, 'Acc.truck': 0.6655000305175781, 'Acc.bus': 0.8888999938964843, 'Acc.train': 0.0009000000357627869, 'Acc.motorcycle': 0.845999984741211, 'Acc.bicycle': 0.6683999633789063}], 'val/avg_miou': 23.58}
[2025-10-21 16:44:54 default] (main.py 245): INFO  >> 23.58, 23.58
[2025-10-21 16:44:54 default] (main.py 246): INFO Experiment dir: output/eval
[2025-10-21 16:44:54 default] (main.py 145): INFO Saved results at segmentation_results/vitb_jscc_infonce.json
[2025-10-21 16:44:54 default] (main.py 607): INFO Experiment dir: output/eval
[2025-10-21 16:45:25 default] (main.py 589): INFO Full config saved to output/eval/config.json
[2025-10-21 16:45:25 default] (main.py 595): INFO Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3: NVIDIA GeForce RTX 4090
CUDA_HOME: /usr/local/cuda-11.8
NVCC: Cuda compilation tools, release 11.8, V11.8.89
GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
PyTorch: 1.13.1+cu117
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

TorchVision: 0.14.1+cu117
OpenCV: 4.6.0
MMCV: 1.6.2
MMCV Compiler: GCC 9.4
MMCV CUDA Compiler: 11.8
------------------------------------------------------------

[2025-10-21 16:45:25 default] (main.py 597): INFO Git hash: ef51a59
[2025-10-21 16:45:25 default] (main.py 600): INFO evaluate:
  pamr: false
  bg_thresh: 0.4
  kp_w: 0.3
  pred_qual_path: null
  gt_qual_path: null
  eval_only: true
  template: sub_imagenet_template
  task:
  - cityscapes
  t_voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_voc12_20.py
  t_context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_context59.py
  voc: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12.py
  voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12_20.py
  context: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context.py
  context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context59.py
  coco_stuff: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/stuff.py
  coco_object: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/coco.py
  cityscapes: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/cityscapes.py
  ade20k: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/ade20k.py
  save_logits: null
  eval_freq: 5000
_base_: default.yml
data:
  batch_size: 256
  pin_memory: true
  num_workers: 0
  seed: ${train.seed}
  dataset:
    meta:
      gcc3m:
        type: img_txt_pair
        path: ./data/gcc3m
        prefix: gcc-train-{000000..00347}.tar
        length: 2881393
      gcc12m:
        type: img_txt_pair
        path: ./data/gcc12m
        prefix: cc-{000000..001175}.tar
        length: 11286526
    train:
    - gcc3m
    - gcc12m
  img_aug:
    deit_aug: true
    img_size: 224
    img_scale:
    - 0.08
    - 1.0
    interpolation: bilinear
    color_jitter: 0.4
    auto_augment: rand-m9-mstd0.5-inc1
    re_prob: 0.25
    re_mode: pixel
    re_count: 1
  text_aug: null
train:
  start_step: 0
  total_steps: 50000
  warmup_steps: 20000
  ust_steps: 0
  base_lr: 0.0016
  weight_decay: 0.05
  min_lr: 4.0e-05
  clip_grad: 5.0
  fp16: true
  fp16_comm: true
  seed: 42
  lr_scheduler:
    name: cosine
  optimizer:
    name: adamw
    eps: 1.0e-08
    betas:
    - 0.9
    - 0.999
checkpoint:
  resume: ''
  save_topk: 0
  save_all: false
model_name: default
output: output/eval
tag: default
print_freq: 20
seed: 42
wandb: false
model:
  clip_model_name: ViT-B/16
  keep_cls: false
  keep_end_seq: false
  model_name: dinov2_vitb14_reg
  proj_model: DINOJSCC_Adapter
  proj_name: vitb_jscc_infonce
  proj_class: vitb_jscc_infonce
  resize_dim: 518
  type: DINOJSCC
  use_avg_text_token: false
  k: 36
  text_adapter_pretrain: weights/vitb_mlp_infonce.pth

[2025-10-21 16:45:25 default] (main.py 202): INFO Creating model:DINOJSCC/default
[2025-10-21 16:45:30 default] (main.py 221): INFO number of params: 649633 (0.6M)
[2025-10-21 16:45:30 default] (main.py 225): INFO GROUP_RANK = 0 | LOCAL_RANK = 0 | RANK = 0 | MASTER_ADDR = 127.0.0.1 | MASTER_PORT = 29500 | ROLE_RANK = 0 | LOCAL_WORLD_SIZE = 1 | WORLD_SIZE = 1 | ROLE_WORLD_SIZE = 1 | TORCHELASTIC_RESTART_COUNT = 0 | TORCHELASTIC_MAX_RESTARTS = 0 | TORCHELASTIC_RUN_ID = none
[2025-10-21 16:45:30 default] (main.py 232): INFO !!! Single-node setting :: skip fp16 compression hook
[2025-10-21 16:45:30 default] (main.py 450): INFO ### Validation dataset: cityscapes (Subset)
[2025-10-21 16:45:32 default] (dinotext_seg.py 43): INFO Building DINOTextSegInference with 19 classes, test_cfg=Config (path: None): {'mode': 'slide', 'stride': (224, 224), 'crop_size': (448, 448)}, with_bg=False, pamr=False, bg_thresh=0.4
[2025-10-21 16:47:25 default] (logging.py 102): INFO per class results:
[2025-10-21 16:47:25 default] (logging.py 102): INFO 
+---------------+-------+-------+
|     Class     |  IoU  |  Acc  |
+---------------+-------+-------+
|      road     | 14.99 |  15.4 |
|    sidewalk   | 12.35 | 97.36 |
|    building   | 59.65 | 70.65 |
|      wall     |  5.09 | 25.74 |
|     fence     |  30.7 | 38.25 |
|      pole     |  5.81 |  6.45 |
| traffic light |  9.25 | 87.74 |
|  traffic sign | 28.95 | 59.48 |
|   vegetation  |  2.01 |  2.01 |
|    terrain    |  1.07 |  3.25 |
|      sky      | 21.24 | 84.15 |
|     person    | 34.64 | 40.21 |
|     rider     | 16.13 | 62.91 |
|      car      | 69.09 | 74.13 |
|     truck     | 32.35 | 65.76 |
|      bus      | 28.62 | 88.75 |
|     train     |  0.09 |  0.1  |
|   motorcycle  | 23.84 | 84.36 |
|    bicycle    | 48.79 | 66.19 |
+---------------+-------+-------+
[2025-10-21 16:47:25 default] (logging.py 102): INFO Summary:
[2025-10-21 16:47:25 default] (logging.py 102): INFO 
+-------+------+-------+
|  aAcc | mIoU |  mAcc |
+-------+------+-------+
| 37.48 | 23.4 | 51.21 |
+-------+------+-------+
[2025-10-21 16:47:25 default] (main.py 454): INFO [cityscapes] mIoU of 500 test images: 23.40%
[2025-10-21 16:47:25 default] (main.py 241): INFO {'val/cityscapes_miou': 23.4, 'metrics': [{'aAcc': 0.37479999999999997, 'mIoU': 0.23399999999999999, 'mAcc': 0.5121, 'IoU.road': 0.14989999771118165, 'IoU.sidewalk': 0.12350000381469727, 'IoU.building': 0.596500015258789, 'IoU.wall': 0.0509000015258789, 'IoU.fence': 0.30700000762939456, 'IoU.pole': 0.05809999942779541, 'IoU.traffic light': 0.0925, 'IoU.traffic sign': 0.28950000762939454, 'IoU.vegetation': 0.020099999904632567, 'IoU.terrain': 0.010700000524520874, 'IoU.sky': 0.21239999771118165, 'IoU.person': 0.34639999389648435, 'IoU.rider': 0.161299991607666, 'IoU.car': 0.6908999633789062, 'IoU.truck': 0.32349998474121094, 'IoU.bus': 0.286200008392334, 'IoU.train': 0.0009000000357627869, 'IoU.motorcycle': 0.2384000015258789, 'IoU.bicycle': 0.48790000915527343, 'Acc.road': 0.15399999618530275, 'Acc.sidewalk': 0.9736000061035156, 'Acc.building': 0.706500015258789, 'Acc.wall': 0.25739999771118166, 'Acc.fence': 0.3825, 'Acc.pole': 0.06449999809265136, 'Acc.traffic light': 0.8773999786376954, 'Acc.traffic sign': 0.5947999954223633, 'Acc.vegetation': 0.020099999904632567, 'Acc.terrain': 0.0325, 'Acc.sky': 0.841500015258789, 'Acc.person': 0.4020999908447266, 'Acc.rider': 0.6290999984741211, 'Acc.car': 0.7412999725341797, 'Acc.truck': 0.6576000213623047, 'Acc.bus': 0.8875, 'Acc.train': 0.0010000000149011613, 'Acc.motorcycle': 0.8436000061035156, 'Acc.bicycle': 0.6619000244140625}], 'val/avg_miou': 23.4}
[2025-10-21 16:47:25 default] (main.py 245): INFO  >> 23.40, 23.40
[2025-10-21 16:47:25 default] (main.py 246): INFO Experiment dir: output/eval
[2025-10-21 16:47:25 default] (main.py 145): INFO Saved results at segmentation_results/vitb_jscc_infonce.json
[2025-10-21 16:47:25 default] (main.py 607): INFO Experiment dir: output/eval
[2025-10-21 16:47:54 default] (main.py 589): INFO Full config saved to output/eval/config.json
[2025-10-21 16:47:54 default] (main.py 595): INFO Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3: NVIDIA GeForce RTX 4090
CUDA_HOME: /usr/local/cuda-11.8
NVCC: Cuda compilation tools, release 11.8, V11.8.89
GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
PyTorch: 1.13.1+cu117
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

TorchVision: 0.14.1+cu117
OpenCV: 4.6.0
MMCV: 1.6.2
MMCV Compiler: GCC 9.4
MMCV CUDA Compiler: 11.8
------------------------------------------------------------

[2025-10-21 16:47:54 default] (main.py 597): INFO Git hash: ef51a59
[2025-10-21 16:47:54 default] (main.py 600): INFO evaluate:
  pamr: false
  bg_thresh: 0.4
  kp_w: 0.3
  pred_qual_path: null
  gt_qual_path: null
  eval_only: true
  template: sub_imagenet_template
  task:
  - cityscapes
  t_voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_voc12_20.py
  t_context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_context59.py
  voc: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12.py
  voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12_20.py
  context: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context.py
  context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context59.py
  coco_stuff: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/stuff.py
  coco_object: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/coco.py
  cityscapes: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/cityscapes.py
  ade20k: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/ade20k.py
  save_logits: null
  eval_freq: 5000
_base_: default.yml
data:
  batch_size: 256
  pin_memory: true
  num_workers: 0
  seed: ${train.seed}
  dataset:
    meta:
      gcc3m:
        type: img_txt_pair
        path: ./data/gcc3m
        prefix: gcc-train-{000000..00347}.tar
        length: 2881393
      gcc12m:
        type: img_txt_pair
        path: ./data/gcc12m
        prefix: cc-{000000..001175}.tar
        length: 11286526
    train:
    - gcc3m
    - gcc12m
  img_aug:
    deit_aug: true
    img_size: 224
    img_scale:
    - 0.08
    - 1.0
    interpolation: bilinear
    color_jitter: 0.4
    auto_augment: rand-m9-mstd0.5-inc1
    re_prob: 0.25
    re_mode: pixel
    re_count: 1
  text_aug: null
train:
  start_step: 0
  total_steps: 50000
  warmup_steps: 20000
  ust_steps: 0
  base_lr: 0.0016
  weight_decay: 0.05
  min_lr: 4.0e-05
  clip_grad: 5.0
  fp16: true
  fp16_comm: true
  seed: 42
  lr_scheduler:
    name: cosine
  optimizer:
    name: adamw
    eps: 1.0e-08
    betas:
    - 0.9
    - 0.999
checkpoint:
  resume: ''
  save_topk: 0
  save_all: false
model_name: default
output: output/eval
tag: default
print_freq: 20
seed: 42
wandb: false
model:
  clip_model_name: ViT-B/16
  keep_cls: false
  keep_end_seq: false
  model_name: dinov2_vitb14_reg
  proj_model: DINOJSCC_Adapter
  proj_name: vitb_jscc_infonce
  proj_class: vitb_jscc_infonce
  resize_dim: 518
  type: DINOJSCC
  use_avg_text_token: false
  k: 36
  text_adapter_pretrain: weights/vitb_mlp_infonce.pth

[2025-10-21 16:47:54 default] (main.py 202): INFO Creating model:DINOJSCC/default
[2025-10-21 16:47:59 default] (main.py 221): INFO number of params: 649633 (0.6M)
[2025-10-21 16:47:59 default] (main.py 225): INFO GROUP_RANK = 0 | LOCAL_RANK = 0 | RANK = 0 | MASTER_ADDR = 127.0.0.1 | MASTER_PORT = 29500 | ROLE_RANK = 0 | LOCAL_WORLD_SIZE = 1 | WORLD_SIZE = 1 | ROLE_WORLD_SIZE = 1 | TORCHELASTIC_RESTART_COUNT = 0 | TORCHELASTIC_MAX_RESTARTS = 0 | TORCHELASTIC_RUN_ID = none
[2025-10-21 16:47:59 default] (main.py 232): INFO !!! Single-node setting :: skip fp16 compression hook
[2025-10-21 16:47:59 default] (main.py 450): INFO ### Validation dataset: cityscapes (Subset)
[2025-10-21 16:48:00 default] (dinotext_seg.py 43): INFO Building DINOTextSegInference with 19 classes, test_cfg=Config (path: None): {'mode': 'slide', 'stride': (224, 224), 'crop_size': (448, 448)}, with_bg=False, pamr=False, bg_thresh=0.4
[2025-10-21 16:49:42 default] (logging.py 102): INFO per class results:
[2025-10-21 16:49:42 default] (logging.py 102): INFO 
+---------------+-------+-------+
|     Class     |  IoU  |  Acc  |
+---------------+-------+-------+
|      road     |  17.1 | 17.63 |
|    sidewalk   | 12.53 | 96.63 |
|    building   | 57.76 | 67.71 |
|      wall     |  4.65 | 24.62 |
|     fence     | 28.92 |  36.9 |
|      pole     |  6.19 |  6.99 |
| traffic light |  9.08 | 86.11 |
|  traffic sign |  27.1 | 56.33 |
|   vegetation  |  1.99 |  1.99 |
|    terrain    |  1.35 |  4.37 |
|      sky      | 20.61 | 85.01 |
|     person    |  34.3 | 40.09 |
|     rider     | 15.07 | 62.57 |
|      car      | 66.46 | 70.91 |
|     truck     | 30.03 | 62.08 |
|      bus      | 25.74 | 87.96 |
|     train     |  0.16 |  0.19 |
|   motorcycle  | 22.87 | 83.27 |
|    bicycle    | 45.99 | 63.25 |
+---------------+-------+-------+
[2025-10-21 16:49:42 default] (logging.py 102): INFO Summary:
[2025-10-21 16:49:42 default] (logging.py 102): INFO 
+-------+-------+-------+
|  aAcc |  mIoU |  mAcc |
+-------+-------+-------+
| 37.39 | 22.52 | 50.24 |
+-------+-------+-------+
[2025-10-21 16:49:42 default] (main.py 454): INFO [cityscapes] mIoU of 500 test images: 22.52%
[2025-10-21 16:49:42 default] (main.py 241): INFO {'val/cityscapes_miou': 22.52, 'metrics': [{'aAcc': 0.3739, 'mIoU': 0.22519999999999998, 'mAcc': 0.5024000000000001, 'IoU.road': 0.17100000381469727, 'IoU.sidewalk': 0.12529999732971192, 'IoU.building': 0.577599983215332, 'IoU.wall': 0.04650000095367432, 'IoU.fence': 0.28920000076293945, 'IoU.pole': 0.06190000057220459, 'IoU.traffic light': 0.09079999923706054, 'IoU.traffic sign': 0.27100000381469724, 'IoU.vegetation': 0.01990000009536743, 'IoU.terrain': 0.01350000023841858, 'IoU.sky': 0.20610000610351562, 'IoU.person': 0.34299999237060547, 'IoU.rider': 0.15069999694824218, 'IoU.car': 0.6645999908447265, 'IoU.truck': 0.3003000068664551, 'IoU.bus': 0.25739999771118166, 'IoU.train': 0.001599999964237213, 'IoU.motorcycle': 0.22870000839233398, 'IoU.bicycle': 0.45990001678466796, 'Acc.road': 0.17629999160766602, 'Acc.sidewalk': 0.9662999725341797, 'Acc.building': 0.6770999908447266, 'Acc.wall': 0.246200008392334, 'Acc.fence': 0.36900001525878906, 'Acc.pole': 0.06989999771118165, 'Acc.traffic light': 0.8611000061035157, 'Acc.traffic sign': 0.5633000183105469, 'Acc.vegetation': 0.01990000009536743, 'Acc.terrain': 0.04369999885559082, 'Acc.sky': 0.8501000213623047, 'Acc.person': 0.4009000015258789, 'Acc.rider': 0.6256999969482422, 'Acc.car': 0.7091000366210938, 'Acc.truck': 0.6208000183105469, 'Acc.bus': 0.8795999908447265, 'Acc.train': 0.001899999976158142, 'Acc.motorcycle': 0.832699966430664, 'Acc.bicycle': 0.6325}], 'val/avg_miou': 22.52}
[2025-10-21 16:49:42 default] (main.py 245): INFO  >> 22.52, 22.52
[2025-10-21 16:49:42 default] (main.py 246): INFO Experiment dir: output/eval
[2025-10-21 16:49:42 default] (main.py 145): INFO Saved results at segmentation_results/vitb_jscc_infonce.json
[2025-10-21 16:49:42 default] (main.py 607): INFO Experiment dir: output/eval
[2025-10-21 16:50:17 default] (main.py 589): INFO Full config saved to output/eval/config.json
[2025-10-21 16:50:17 default] (main.py 595): INFO Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3: NVIDIA GeForce RTX 4090
CUDA_HOME: /usr/local/cuda-11.8
NVCC: Cuda compilation tools, release 11.8, V11.8.89
GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
PyTorch: 1.13.1+cu117
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

TorchVision: 0.14.1+cu117
OpenCV: 4.6.0
MMCV: 1.6.2
MMCV Compiler: GCC 9.4
MMCV CUDA Compiler: 11.8
------------------------------------------------------------

[2025-10-21 16:50:17 default] (main.py 597): INFO Git hash: ef51a59
[2025-10-21 16:50:17 default] (main.py 600): INFO evaluate:
  pamr: false
  bg_thresh: 0.4
  kp_w: 0.3
  pred_qual_path: null
  gt_qual_path: null
  eval_only: true
  template: sub_imagenet_template
  task:
  - cityscapes
  t_voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_voc12_20.py
  t_context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_context59.py
  voc: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12.py
  voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12_20.py
  context: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context.py
  context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context59.py
  coco_stuff: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/stuff.py
  coco_object: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/coco.py
  cityscapes: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/cityscapes.py
  ade20k: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/ade20k.py
  save_logits: null
  eval_freq: 5000
_base_: default.yml
data:
  batch_size: 256
  pin_memory: true
  num_workers: 0
  seed: ${train.seed}
  dataset:
    meta:
      gcc3m:
        type: img_txt_pair
        path: ./data/gcc3m
        prefix: gcc-train-{000000..00347}.tar
        length: 2881393
      gcc12m:
        type: img_txt_pair
        path: ./data/gcc12m
        prefix: cc-{000000..001175}.tar
        length: 11286526
    train:
    - gcc3m
    - gcc12m
  img_aug:
    deit_aug: true
    img_size: 224
    img_scale:
    - 0.08
    - 1.0
    interpolation: bilinear
    color_jitter: 0.4
    auto_augment: rand-m9-mstd0.5-inc1
    re_prob: 0.25
    re_mode: pixel
    re_count: 1
  text_aug: null
train:
  start_step: 0
  total_steps: 50000
  warmup_steps: 20000
  ust_steps: 0
  base_lr: 0.0016
  weight_decay: 0.05
  min_lr: 4.0e-05
  clip_grad: 5.0
  fp16: true
  fp16_comm: true
  seed: 42
  lr_scheduler:
    name: cosine
  optimizer:
    name: adamw
    eps: 1.0e-08
    betas:
    - 0.9
    - 0.999
checkpoint:
  resume: ''
  save_topk: 0
  save_all: false
model_name: default
output: output/eval
tag: default
print_freq: 20
seed: 42
wandb: false
model:
  clip_model_name: ViT-B/16
  keep_cls: false
  keep_end_seq: false
  model_name: dinov2_vitb14_reg
  proj_model: DINOJSCC_Adapter
  proj_name: vitb_jscc_infonce
  proj_class: vitb_jscc_infonce
  resize_dim: 518
  type: DINOJSCC
  use_avg_text_token: false
  k: 36
  text_adapter_pretrain: weights/vitb_mlp_infonce.pth

[2025-10-21 16:50:17 default] (main.py 202): INFO Creating model:DINOJSCC/default
[2025-10-21 16:50:23 default] (main.py 221): INFO number of params: 649633 (0.6M)
[2025-10-21 16:50:23 default] (main.py 225): INFO GROUP_RANK = 0 | LOCAL_RANK = 0 | RANK = 0 | MASTER_ADDR = 127.0.0.1 | MASTER_PORT = 29500 | ROLE_RANK = 0 | LOCAL_WORLD_SIZE = 1 | WORLD_SIZE = 1 | ROLE_WORLD_SIZE = 1 | TORCHELASTIC_RESTART_COUNT = 0 | TORCHELASTIC_MAX_RESTARTS = 0 | TORCHELASTIC_RUN_ID = none
[2025-10-21 16:50:23 default] (main.py 232): INFO !!! Single-node setting :: skip fp16 compression hook
[2025-10-21 16:50:23 default] (main.py 450): INFO ### Validation dataset: cityscapes (Subset)
[2025-10-21 16:50:24 default] (dinotext_seg.py 43): INFO Building DINOTextSegInference with 19 classes, test_cfg=Config (path: None): {'mode': 'slide', 'stride': (224, 224), 'crop_size': (448, 448)}, with_bg=False, pamr=False, bg_thresh=0.4
[2025-10-21 16:52:25 default] (logging.py 102): INFO per class results:
[2025-10-21 16:52:25 default] (logging.py 102): INFO 
+---------------+-------+-------+
|     Class     |  IoU  |  Acc  |
+---------------+-------+-------+
|      road     | 17.81 | 18.39 |
|    sidewalk   |  12.6 | 96.31 |
|    building   | 56.93 | 66.47 |
|      wall     |  4.52 | 24.26 |
|     fence     | 28.26 | 36.37 |
|      pole     |  6.28 |  7.14 |
| traffic light |  8.99 | 85.38 |
|  traffic sign | 26.38 | 55.19 |
|   vegetation  |  1.98 |  1.98 |
|    terrain    |  1.43 |  4.77 |
|      sky      | 20.34 | 85.32 |
|     person    | 34.07 | 39.98 |
|     rider     | 14.62 | 62.41 |
|      car      | 65.36 |  69.6 |
|     truck     | 29.06 | 60.57 |
|      bus      | 24.66 | 87.58 |
|     train     |  0.19 |  0.23 |
|   motorcycle  | 22.45 | 82.76 |
|    bicycle    | 44.97 | 62.14 |
+---------------+-------+-------+
[2025-10-21 16:52:25 default] (logging.py 102): INFO Summary:
[2025-10-21 16:52:25 default] (logging.py 102): INFO 
+-------+-------+-------+
|  aAcc |  mIoU |  mAcc |
+-------+-------+-------+
| 37.28 | 22.15 | 49.83 |
+-------+-------+-------+
[2025-10-21 16:52:25 default] (main.py 454): INFO [cityscapes] mIoU of 500 test images: 22.15%
[2025-10-21 16:52:25 default] (main.py 241): INFO {'val/cityscapes_miou': 22.15, 'metrics': [{'aAcc': 0.3728, 'mIoU': 0.22149999999999997, 'mAcc': 0.49829999999999997, 'IoU.road': 0.17809999465942383, 'IoU.sidewalk': 0.12600000381469725, 'IoU.building': 0.5693000030517578, 'IoU.wall': 0.04519999980926514, 'IoU.fence': 0.2826000022888184, 'IoU.pole': 0.0628000020980835, 'IoU.traffic light': 0.08989999771118164, 'IoU.traffic sign': 0.26379999160766604, 'IoU.vegetation': 0.019800000190734864, 'IoU.terrain': 0.014299999475479126, 'IoU.sky': 0.2034000015258789, 'IoU.person': 0.3406999969482422, 'IoU.rider': 0.14619999885559082, 'IoU.car': 0.6536000061035157, 'IoU.truck': 0.2905999946594238, 'IoU.bus': 0.2465999984741211, 'IoU.train': 0.001899999976158142, 'IoU.motorcycle': 0.22450000762939454, 'IoU.bicycle': 0.44970001220703126, 'Acc.road': 0.18389999389648437, 'Acc.sidewalk': 0.9630999755859375, 'Acc.building': 0.6647000122070312, 'Acc.wall': 0.24260000228881837, 'Acc.fence': 0.36369998931884767, 'Acc.pole': 0.07139999866485595, 'Acc.traffic light': 0.8537999725341797, 'Acc.traffic sign': 0.5518999862670898, 'Acc.vegetation': 0.019800000190734864, 'Acc.terrain': 0.047699999809265134, 'Acc.sky': 0.8531999969482422, 'Acc.person': 0.3997999954223633, 'Acc.rider': 0.6240999984741211, 'Acc.car': 0.6959999847412109, 'Acc.truck': 0.6056999969482422, 'Acc.bus': 0.8758000183105469, 'Acc.train': 0.0023000000417232516, 'Acc.motorcycle': 0.8276000213623047, 'Acc.bicycle': 0.6213999938964844}], 'val/avg_miou': 22.15}
[2025-10-21 16:52:25 default] (main.py 245): INFO  >> 22.15, 22.15
[2025-10-21 16:52:25 default] (main.py 246): INFO Experiment dir: output/eval
[2025-10-21 16:52:25 default] (main.py 145): INFO Saved results at segmentation_results/vitb_jscc_infonce.json
[2025-10-21 16:52:25 default] (main.py 607): INFO Experiment dir: output/eval
[2025-10-21 16:54:06 default] (main.py 589): INFO Full config saved to output/eval/config.json
[2025-10-21 16:54:06 default] (main.py 595): INFO Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3: NVIDIA GeForce RTX 4090
CUDA_HOME: /usr/local/cuda-11.8
NVCC: Cuda compilation tools, release 11.8, V11.8.89
GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
PyTorch: 1.13.1+cu117
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

TorchVision: 0.14.1+cu117
OpenCV: 4.6.0
MMCV: 1.6.2
MMCV Compiler: GCC 9.4
MMCV CUDA Compiler: 11.8
------------------------------------------------------------

[2025-10-21 16:54:06 default] (main.py 597): INFO Git hash: ef51a59
[2025-10-21 16:54:06 default] (main.py 600): INFO evaluate:
  pamr: false
  bg_thresh: 0.4
  kp_w: 0.3
  pred_qual_path: null
  gt_qual_path: null
  eval_only: true
  template: sub_imagenet_template
  task:
  - cityscapes
  t_voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_voc12_20.py
  t_context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_context59.py
  voc: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12.py
  voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12_20.py
  context: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context.py
  context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context59.py
  coco_stuff: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/stuff.py
  coco_object: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/coco.py
  cityscapes: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/cityscapes.py
  ade20k: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/ade20k.py
  save_logits: null
  eval_freq: 5000
_base_: default.yml
data:
  batch_size: 256
  pin_memory: true
  num_workers: 0
  seed: ${train.seed}
  dataset:
    meta:
      gcc3m:
        type: img_txt_pair
        path: ./data/gcc3m
        prefix: gcc-train-{000000..00347}.tar
        length: 2881393
      gcc12m:
        type: img_txt_pair
        path: ./data/gcc12m
        prefix: cc-{000000..001175}.tar
        length: 11286526
    train:
    - gcc3m
    - gcc12m
  img_aug:
    deit_aug: true
    img_size: 224
    img_scale:
    - 0.08
    - 1.0
    interpolation: bilinear
    color_jitter: 0.4
    auto_augment: rand-m9-mstd0.5-inc1
    re_prob: 0.25
    re_mode: pixel
    re_count: 1
  text_aug: null
train:
  start_step: 0
  total_steps: 50000
  warmup_steps: 20000
  ust_steps: 0
  base_lr: 0.0016
  weight_decay: 0.05
  min_lr: 4.0e-05
  clip_grad: 5.0
  fp16: true
  fp16_comm: true
  seed: 42
  lr_scheduler:
    name: cosine
  optimizer:
    name: adamw
    eps: 1.0e-08
    betas:
    - 0.9
    - 0.999
checkpoint:
  resume: ''
  save_topk: 0
  save_all: false
model_name: default
output: output/eval
tag: default
print_freq: 20
seed: 42
wandb: false
model:
  clip_model_name: ViT-B/16
  keep_cls: false
  keep_end_seq: false
  model_name: dinov2_vitb14_reg
  proj_model: DINOJSCC_Adapter
  proj_name: vitb_jscc_infonce
  proj_class: vitb_jscc_infonce
  resize_dim: 518
  type: DINOJSCC
  use_avg_text_token: false
  k: 36
  text_adapter_pretrain: weights/vitb_mlp_infonce.pth

[2025-10-21 16:54:06 default] (main.py 202): INFO Creating model:DINOJSCC/default
[2025-10-21 16:54:12 default] (main.py 221): INFO number of params: 649633 (0.6M)
[2025-10-21 16:54:12 default] (main.py 225): INFO GROUP_RANK = 0 | LOCAL_RANK = 0 | RANK = 0 | MASTER_ADDR = 127.0.0.1 | MASTER_PORT = 29500 | ROLE_RANK = 0 | LOCAL_WORLD_SIZE = 1 | WORLD_SIZE = 1 | ROLE_WORLD_SIZE = 1 | TORCHELASTIC_RESTART_COUNT = 0 | TORCHELASTIC_MAX_RESTARTS = 0 | TORCHELASTIC_RUN_ID = none
[2025-10-21 16:54:12 default] (main.py 232): INFO !!! Single-node setting :: skip fp16 compression hook
[2025-10-21 16:54:12 default] (main.py 450): INFO ### Validation dataset: cityscapes (Subset)
[2025-10-21 16:54:13 default] (dinotext_seg.py 43): INFO Building DINOTextSegInference with 19 classes, test_cfg=Config (path: None): {'mode': 'slide', 'stride': (224, 224), 'crop_size': (448, 448)}, with_bg=False, pamr=False, bg_thresh=0.4
[2025-10-21 16:56:00 default] (logging.py 102): INFO per class results:
[2025-10-21 16:56:00 default] (logging.py 102): INFO 
+---------------+-------+-------+
|     Class     |  IoU  |  Acc  |
+---------------+-------+-------+
|      road     |  20.6 | 21.41 |
|    sidewalk   | 12.83 | 94.38 |
|    building   | 52.18 | 59.72 |
|      wall     |  4.01 | 22.86 |
|     fence     | 25.13 | 33.75 |
|      pole     |  6.56 |  7.68 |
| traffic light |  8.39 | 81.49 |
|  traffic sign | 23.01 | 49.93 |
|   vegetation  |  1.94 |  1.94 |
|    terrain    |  1.68 |  6.56 |
|      sky      | 18.85 | 86.65 |
|     person    | 32.52 | 39.38 |
|     rider     | 12.15 | 61.28 |
|      car      | 59.16 | 62.46 |
|     truck     | 24.71 | 53.29 |
|      bus      | 19.68 | 85.27 |
|     train     |  0.25 |  0.38 |
|   motorcycle  |  20.3 | 79.68 |
|    bicycle    | 40.27 | 56.95 |
+---------------+-------+-------+
[2025-10-21 16:56:00 default] (logging.py 102): INFO Summary:
[2025-10-21 16:56:00 default] (logging.py 102): INFO 
+-------+-------+-------+
|  aAcc |  mIoU |  mAcc |
+-------+-------+-------+
| 36.28 | 20.22 | 47.64 |
+-------+-------+-------+
[2025-10-21 16:56:00 default] (main.py 454): INFO [cityscapes] mIoU of 500 test images: 20.22%
[2025-10-21 16:56:00 default] (main.py 241): INFO {'val/cityscapes_miou': 20.22, 'metrics': [{'aAcc': 0.3628, 'mIoU': 0.2022, 'mAcc': 0.4764, 'IoU.road': 0.20600000381469727, 'IoU.sidewalk': 0.12829999923706054, 'IoU.building': 0.5218000030517578, 'IoU.wall': 0.04010000228881836, 'IoU.fence': 0.25129999160766603, 'IoU.pole': 0.06559999942779542, 'IoU.traffic light': 0.08390000343322754, 'IoU.traffic sign': 0.23010000228881836, 'IoU.vegetation': 0.01940000057220459, 'IoU.terrain': 0.016799999475479124, 'IoU.sky': 0.18850000381469725, 'IoU.person': 0.3252000045776367, 'IoU.rider': 0.12149999618530273, 'IoU.car': 0.5915999984741211, 'IoU.truck': 0.24709999084472656, 'IoU.bus': 0.19680000305175782, 'IoU.train': 0.0025, 'IoU.motorcycle': 0.20299999237060548, 'IoU.bicycle': 0.4027000045776367, 'Acc.road': 0.2140999984741211, 'Acc.sidewalk': 0.9437999725341797, 'Acc.building': 0.5972000122070312, 'Acc.wall': 0.22860000610351563, 'Acc.fence': 0.3375, 'Acc.pole': 0.07679999828338623, 'Acc.traffic light': 0.8148999786376954, 'Acc.traffic sign': 0.4993000030517578, 'Acc.vegetation': 0.01940000057220459, 'Acc.terrain': 0.06559999942779542, 'Acc.sky': 0.8665000152587891, 'Acc.person': 0.39380001068115233, 'Acc.rider': 0.6127999877929687, 'Acc.car': 0.6245999908447266, 'Acc.truck': 0.5329000091552735, 'Acc.bus': 0.852699966430664, 'Acc.train': 0.003799999952316284, 'Acc.motorcycle': 0.7968000030517578, 'Acc.bicycle': 0.5695000076293946}], 'val/avg_miou': 20.22}
[2025-10-21 16:56:00 default] (main.py 245): INFO  >> 20.22, 20.22
[2025-10-21 16:56:00 default] (main.py 246): INFO Experiment dir: output/eval
[2025-10-21 16:56:00 default] (main.py 145): INFO Saved results at segmentation_results/vitb_jscc_infonce.json
[2025-10-21 16:56:00 default] (main.py 607): INFO Experiment dir: output/eval
[2025-10-21 16:57:12 default] (main.py 589): INFO Full config saved to output/eval/config.json
[2025-10-21 16:57:12 default] (main.py 595): INFO Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3: NVIDIA GeForce RTX 4090
CUDA_HOME: /usr/local/cuda-11.8
NVCC: Cuda compilation tools, release 11.8, V11.8.89
GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
PyTorch: 1.13.1+cu117
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

TorchVision: 0.14.1+cu117
OpenCV: 4.6.0
MMCV: 1.6.2
MMCV Compiler: GCC 9.4
MMCV CUDA Compiler: 11.8
------------------------------------------------------------

[2025-10-21 16:57:12 default] (main.py 597): INFO Git hash: ef51a59
[2025-10-21 16:57:12 default] (main.py 600): INFO evaluate:
  pamr: false
  bg_thresh: 0.4
  kp_w: 0.3
  pred_qual_path: null
  gt_qual_path: null
  eval_only: true
  template: sub_imagenet_template
  task:
  - cityscapes
  t_voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_voc12_20.py
  t_context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_context59.py
  voc: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12.py
  voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12_20.py
  context: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context.py
  context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context59.py
  coco_stuff: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/stuff.py
  coco_object: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/coco.py
  cityscapes: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/cityscapes.py
  ade20k: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/ade20k.py
  save_logits: null
  eval_freq: 5000
_base_: default.yml
data:
  batch_size: 256
  pin_memory: true
  num_workers: 0
  seed: ${train.seed}
  dataset:
    meta:
      gcc3m:
        type: img_txt_pair
        path: ./data/gcc3m
        prefix: gcc-train-{000000..00347}.tar
        length: 2881393
      gcc12m:
        type: img_txt_pair
        path: ./data/gcc12m
        prefix: cc-{000000..001175}.tar
        length: 11286526
    train:
    - gcc3m
    - gcc12m
  img_aug:
    deit_aug: true
    img_size: 224
    img_scale:
    - 0.08
    - 1.0
    interpolation: bilinear
    color_jitter: 0.4
    auto_augment: rand-m9-mstd0.5-inc1
    re_prob: 0.25
    re_mode: pixel
    re_count: 1
  text_aug: null
train:
  start_step: 0
  total_steps: 50000
  warmup_steps: 20000
  ust_steps: 0
  base_lr: 0.0016
  weight_decay: 0.05
  min_lr: 4.0e-05
  clip_grad: 5.0
  fp16: true
  fp16_comm: true
  seed: 42
  lr_scheduler:
    name: cosine
  optimizer:
    name: adamw
    eps: 1.0e-08
    betas:
    - 0.9
    - 0.999
checkpoint:
  resume: ''
  save_topk: 0
  save_all: false
model_name: default
output: output/eval
tag: default
print_freq: 20
seed: 42
wandb: false
model:
  clip_model_name: ViT-B/16
  keep_cls: false
  keep_end_seq: false
  model_name: dinov2_vitb14_reg
  proj_model: DINOJSCC_Adapter
  proj_name: vitb_jscc_infonce
  proj_class: vitb_jscc_infonce
  resize_dim: 518
  type: DINOJSCC
  use_avg_text_token: false
  k: 36
  text_adapter_pretrain: weights/vitb_mlp_infonce.pth

[2025-10-21 16:57:12 default] (main.py 202): INFO Creating model:DINOJSCC/default
[2025-10-21 16:57:18 default] (main.py 221): INFO number of params: 649633 (0.6M)
[2025-10-21 16:57:18 default] (main.py 225): INFO GROUP_RANK = 0 | LOCAL_RANK = 0 | RANK = 0 | MASTER_ADDR = 127.0.0.1 | MASTER_PORT = 29500 | ROLE_RANK = 0 | LOCAL_WORLD_SIZE = 1 | WORLD_SIZE = 1 | ROLE_WORLD_SIZE = 1 | TORCHELASTIC_RESTART_COUNT = 0 | TORCHELASTIC_MAX_RESTARTS = 0 | TORCHELASTIC_RUN_ID = none
[2025-10-21 16:57:18 default] (main.py 232): INFO !!! Single-node setting :: skip fp16 compression hook
[2025-10-21 16:57:18 default] (main.py 450): INFO ### Validation dataset: cityscapes (Subset)
[2025-10-21 16:57:19 default] (dinotext_seg.py 43): INFO Building DINOTextSegInference with 19 classes, test_cfg=Config (path: None): {'mode': 'slide', 'stride': (224, 224), 'crop_size': (448, 448)}, with_bg=False, pamr=False, bg_thresh=0.4
[2025-10-21 16:58:43 default] (logging.py 102): INFO per class results:
[2025-10-21 16:58:43 default] (logging.py 102): INFO 
+---------------+-------+-------+
|     Class     |  IoU  |  Acc  |
+---------------+-------+-------+
|      road     | 22.67 | 23.76 |
|    sidewalk   | 12.97 | 91.39 |
|    building   | 45.53 | 50.94 |
|      wall     |  3.57 | 21.24 |
|     fence     | 21.84 | 30.76 |
|      pole     |  6.63 |  8.03 |
| traffic light |  7.64 |  76.5 |
|  traffic sign | 19.54 | 44.25 |
|   vegetation  |  1.87 |  1.87 |
|    terrain    |  1.78 |  8.37 |
|      sky      | 17.03 |  87.8 |
|     person    |  29.7 | 38.43 |
|     rider     |  9.45 | 59.65 |
|      car      | 51.31 | 53.76 |
|     truck     | 20.29 | 44.98 |
|      bus      | 15.25 | 81.65 |
|     train     |  0.3  |  0.61 |
|   motorcycle  | 17.83 | 74.76 |
|    bicycle    | 35.47 | 51.76 |
+---------------+-------+-------+
[2025-10-21 16:58:43 default] (logging.py 102): INFO Summary:
[2025-10-21 16:58:43 default] (logging.py 102): INFO 
+-------+-------+-------+
|  aAcc |  mIoU |  mAcc |
+-------+-------+-------+
| 34.37 | 17.93 | 44.76 |
+-------+-------+-------+
[2025-10-21 16:58:43 default] (main.py 454): INFO [cityscapes] mIoU of 500 test images: 17.93%
[2025-10-21 16:58:43 default] (main.py 241): INFO {'val/cityscapes_miou': 17.93, 'metrics': [{'aAcc': 0.34369999999999995, 'mIoU': 0.1793, 'mAcc': 0.4476, 'IoU.road': 0.22670000076293945, 'IoU.sidewalk': 0.12970000267028808, 'IoU.building': 0.45529998779296876, 'IoU.wall': 0.03569999933242798, 'IoU.fence': 0.2184000015258789, 'IoU.pole': 0.06630000114440918, 'IoU.traffic light': 0.07639999866485596, 'IoU.traffic sign': 0.19540000915527345, 'IoU.vegetation': 0.018700000047683716, 'IoU.terrain': 0.017799999713897705, 'IoU.sky': 0.17030000686645508, 'IoU.person': 0.29700000762939455, 'IoU.rider': 0.09449999809265136, 'IoU.car': 0.5131000137329101, 'IoU.truck': 0.20290000915527343, 'IoU.bus': 0.1525, 'IoU.train': 0.0030000001192092896, 'IoU.motorcycle': 0.17829999923706055, 'IoU.bicycle': 0.35470001220703123, 'Acc.road': 0.23760000228881836, 'Acc.sidewalk': 0.9138999938964844, 'Acc.building': 0.5093999862670898, 'Acc.wall': 0.21239999771118165, 'Acc.fence': 0.30760000228881834, 'Acc.pole': 0.08029999732971191, 'Acc.traffic light': 0.765, 'Acc.traffic sign': 0.4425, 'Acc.vegetation': 0.018700000047683716, 'Acc.terrain': 0.08369999885559082, 'Acc.sky': 0.8780000305175781, 'Acc.person': 0.3843000030517578, 'Acc.rider': 0.596500015258789, 'Acc.car': 0.537599983215332, 'Acc.truck': 0.44979999542236326, 'Acc.bus': 0.816500015258789, 'Acc.train': 0.006100000143051148, 'Acc.motorcycle': 0.7476000213623046, 'Acc.bicycle': 0.5175999832153321}], 'val/avg_miou': 17.93}
[2025-10-21 16:58:43 default] (main.py 245): INFO  >> 17.93, 17.93
[2025-10-21 16:58:43 default] (main.py 246): INFO Experiment dir: output/eval
[2025-10-21 16:58:43 default] (main.py 145): INFO Saved results at segmentation_results/vitb_jscc_infonce.json
[2025-10-21 16:58:43 default] (main.py 607): INFO Experiment dir: output/eval
[2025-10-21 16:59:11 default] (main.py 589): INFO Full config saved to output/eval/config.json
[2025-10-21 16:59:11 default] (main.py 595): INFO Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3: NVIDIA GeForce RTX 4090
CUDA_HOME: /usr/local/cuda-11.8
NVCC: Cuda compilation tools, release 11.8, V11.8.89
GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
PyTorch: 1.13.1+cu117
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

TorchVision: 0.14.1+cu117
OpenCV: 4.6.0
MMCV: 1.6.2
MMCV Compiler: GCC 9.4
MMCV CUDA Compiler: 11.8
------------------------------------------------------------

[2025-10-21 16:59:11 default] (main.py 597): INFO Git hash: ef51a59
[2025-10-21 16:59:11 default] (main.py 600): INFO evaluate:
  pamr: false
  bg_thresh: 0.4
  kp_w: 0.3
  pred_qual_path: null
  gt_qual_path: null
  eval_only: true
  template: sub_imagenet_template
  task:
  - cityscapes
  t_voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_voc12_20.py
  t_context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_context59.py
  voc: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12.py
  voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12_20.py
  context: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context.py
  context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context59.py
  coco_stuff: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/stuff.py
  coco_object: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/coco.py
  cityscapes: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/cityscapes.py
  ade20k: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/ade20k.py
  save_logits: null
  eval_freq: 5000
_base_: default.yml
data:
  batch_size: 256
  pin_memory: true
  num_workers: 0
  seed: ${train.seed}
  dataset:
    meta:
      gcc3m:
        type: img_txt_pair
        path: ./data/gcc3m
        prefix: gcc-train-{000000..00347}.tar
        length: 2881393
      gcc12m:
        type: img_txt_pair
        path: ./data/gcc12m
        prefix: cc-{000000..001175}.tar
        length: 11286526
    train:
    - gcc3m
    - gcc12m
  img_aug:
    deit_aug: true
    img_size: 224
    img_scale:
    - 0.08
    - 1.0
    interpolation: bilinear
    color_jitter: 0.4
    auto_augment: rand-m9-mstd0.5-inc1
    re_prob: 0.25
    re_mode: pixel
    re_count: 1
  text_aug: null
train:
  start_step: 0
  total_steps: 50000
  warmup_steps: 20000
  ust_steps: 0
  base_lr: 0.0016
  weight_decay: 0.05
  min_lr: 4.0e-05
  clip_grad: 5.0
  fp16: true
  fp16_comm: true
  seed: 42
  lr_scheduler:
    name: cosine
  optimizer:
    name: adamw
    eps: 1.0e-08
    betas:
    - 0.9
    - 0.999
checkpoint:
  resume: ''
  save_topk: 0
  save_all: false
model_name: default
output: output/eval
tag: default
print_freq: 20
seed: 42
wandb: false
model:
  clip_model_name: ViT-B/16
  keep_cls: false
  keep_end_seq: false
  model_name: dinov2_vitb14_reg
  proj_model: DINOJSCC_Adapter
  proj_name: vitb_jscc_infonce
  proj_class: vitb_jscc_infonce
  resize_dim: 518
  type: DINOJSCC
  use_avg_text_token: false
  k: 36
  text_adapter_pretrain: weights/vitb_mlp_infonce.pth

[2025-10-21 16:59:11 default] (main.py 202): INFO Creating model:DINOJSCC/default
[2025-10-21 16:59:17 default] (main.py 221): INFO number of params: 649633 (0.6M)
[2025-10-21 16:59:17 default] (main.py 225): INFO GROUP_RANK = 0 | LOCAL_RANK = 0 | RANK = 0 | MASTER_ADDR = 127.0.0.1 | MASTER_PORT = 29500 | ROLE_RANK = 0 | LOCAL_WORLD_SIZE = 1 | WORLD_SIZE = 1 | ROLE_WORLD_SIZE = 1 | TORCHELASTIC_RESTART_COUNT = 0 | TORCHELASTIC_MAX_RESTARTS = 0 | TORCHELASTIC_RUN_ID = none
[2025-10-21 16:59:17 default] (main.py 232): INFO !!! Single-node setting :: skip fp16 compression hook
[2025-10-21 16:59:17 default] (main.py 450): INFO ### Validation dataset: cityscapes (Subset)
[2025-10-21 16:59:18 default] (dinotext_seg.py 43): INFO Building DINOTextSegInference with 19 classes, test_cfg=Config (path: None): {'mode': 'slide', 'stride': (224, 224), 'crop_size': (448, 448)}, with_bg=False, pamr=False, bg_thresh=0.4
[2025-10-21 17:00:46 default] (logging.py 102): INFO per class results:
[2025-10-21 17:00:46 default] (logging.py 102): INFO 
+---------------+-------+-------+
|     Class     |  IoU  |  Acc  |
+---------------+-------+-------+
|      road     | 24.45 | 26.12 |
|    sidewalk   | 12.92 | 81.49 |
|    building   | 27.72 | 29.58 |
|      wall     |  2.92 | 17.41 |
|     fence     | 15.28 | 23.88 |
|      pole     |  6.17 |  8.01 |
| traffic light |  6.02 | 63.25 |
|  traffic sign | 13.29 | 32.51 |
|   vegetation  |  1.61 |  1.61 |
|    terrain    |  1.66 | 11.86 |
|      sky      | 13.22 | 89.09 |
|     person    | 21.68 | 35.52 |
|     rider     |  5.28 | 54.79 |
|      car      | 33.64 | 34.87 |
|     truck     | 12.22 | 27.95 |
|      bus      |  9.27 | 69.27 |
|     train     |  0.44 |  1.7  |
|   motorcycle  | 12.26 | 60.82 |
|    bicycle    | 25.48 | 41.12 |
+---------------+-------+-------+
[2025-10-21 17:00:46 default] (logging.py 102): INFO Summary:
[2025-10-21 17:00:46 default] (logging.py 102): INFO 
+-------+-------+-------+
|  aAcc |  mIoU |  mAcc |
+-------+-------+-------+
| 28.42 | 12.92 | 37.41 |
+-------+-------+-------+
[2025-10-21 17:00:46 default] (main.py 454): INFO [cityscapes] mIoU of 500 test images: 12.92%
[2025-10-21 17:00:46 default] (main.py 241): INFO {'val/cityscapes_miou': 12.920000000000002, 'metrics': [{'aAcc': 0.2842, 'mIoU': 0.1292, 'mAcc': 0.3741, 'IoU.road': 0.24450000762939453, 'IoU.sidewalk': 0.12920000076293944, 'IoU.building': 0.27719999313354493, 'IoU.wall': 0.02920000076293945, 'IoU.fence': 0.15279999732971192, 'IoU.pole': 0.06170000076293945, 'IoU.traffic light': 0.06019999980926514, 'IoU.traffic sign': 0.13289999961853027, 'IoU.vegetation': 0.016100000143051147, 'IoU.terrain': 0.01659999966621399, 'IoU.sky': 0.13220000267028809, 'IoU.person': 0.2168000030517578, 'IoU.rider': 0.0528000020980835, 'IoU.car': 0.3363999938964844, 'IoU.truck': 0.12220000267028809, 'IoU.bus': 0.09270000457763672, 'IoU.train': 0.004399999976158142, 'IoU.motorcycle': 0.12260000228881836, 'IoU.bicycle': 0.25479999542236326, 'Acc.road': 0.261200008392334, 'Acc.sidewalk': 0.8148999786376954, 'Acc.building': 0.2957999992370606, 'Acc.wall': 0.17409999847412108, 'Acc.fence': 0.23879999160766602, 'Acc.pole': 0.08010000228881836, 'Acc.traffic light': 0.6325, 'Acc.traffic sign': 0.325099983215332, 'Acc.vegetation': 0.016100000143051147, 'Acc.terrain': 0.11859999656677246, 'Acc.sky': 0.8908999633789062, 'Acc.person': 0.35520000457763673, 'Acc.rider': 0.5479000091552735, 'Acc.car': 0.34869998931884766, 'Acc.truck': 0.27950000762939453, 'Acc.bus': 0.6926999664306641, 'Acc.train': 0.017000000476837158, 'Acc.motorcycle': 0.6081999969482422, 'Acc.bicycle': 0.41119998931884766}], 'val/avg_miou': 12.920000000000002}
[2025-10-21 17:00:46 default] (main.py 245): INFO  >> 12.92, 12.92
[2025-10-21 17:00:46 default] (main.py 246): INFO Experiment dir: output/eval
[2025-10-21 17:00:46 default] (main.py 145): INFO Saved results at segmentation_results/vitb_jscc_infonce.json
[2025-10-21 17:00:46 default] (main.py 607): INFO Experiment dir: output/eval
[2025-10-21 17:01:15 default] (main.py 589): INFO Full config saved to output/eval/config.json
[2025-10-21 17:01:15 default] (main.py 595): INFO Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3: NVIDIA GeForce RTX 4090
CUDA_HOME: /usr/local/cuda-11.8
NVCC: Cuda compilation tools, release 11.8, V11.8.89
GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
PyTorch: 1.13.1+cu117
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

TorchVision: 0.14.1+cu117
OpenCV: 4.6.0
MMCV: 1.6.2
MMCV Compiler: GCC 9.4
MMCV CUDA Compiler: 11.8
------------------------------------------------------------

[2025-10-21 17:01:15 default] (main.py 597): INFO Git hash: ef51a59
[2025-10-21 17:01:15 default] (main.py 600): INFO evaluate:
  pamr: false
  bg_thresh: 0.4
  kp_w: 0.3
  pred_qual_path: null
  gt_qual_path: null
  eval_only: true
  template: sub_imagenet_template
  task:
  - cityscapes
  t_voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_voc12_20.py
  t_context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_context59.py
  voc: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12.py
  voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12_20.py
  context: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context.py
  context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context59.py
  coco_stuff: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/stuff.py
  coco_object: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/coco.py
  cityscapes: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/cityscapes.py
  ade20k: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/ade20k.py
  save_logits: null
  eval_freq: 5000
_base_: default.yml
data:
  batch_size: 256
  pin_memory: true
  num_workers: 0
  seed: ${train.seed}
  dataset:
    meta:
      gcc3m:
        type: img_txt_pair
        path: ./data/gcc3m
        prefix: gcc-train-{000000..00347}.tar
        length: 2881393
      gcc12m:
        type: img_txt_pair
        path: ./data/gcc12m
        prefix: cc-{000000..001175}.tar
        length: 11286526
    train:
    - gcc3m
    - gcc12m
  img_aug:
    deit_aug: true
    img_size: 224
    img_scale:
    - 0.08
    - 1.0
    interpolation: bilinear
    color_jitter: 0.4
    auto_augment: rand-m9-mstd0.5-inc1
    re_prob: 0.25
    re_mode: pixel
    re_count: 1
  text_aug: null
train:
  start_step: 0
  total_steps: 50000
  warmup_steps: 20000
  ust_steps: 0
  base_lr: 0.0016
  weight_decay: 0.05
  min_lr: 4.0e-05
  clip_grad: 5.0
  fp16: true
  fp16_comm: true
  seed: 42
  lr_scheduler:
    name: cosine
  optimizer:
    name: adamw
    eps: 1.0e-08
    betas:
    - 0.9
    - 0.999
checkpoint:
  resume: ''
  save_topk: 0
  save_all: false
model_name: default
output: output/eval
tag: default
print_freq: 20
seed: 42
wandb: false
model:
  clip_model_name: ViT-B/16
  keep_cls: false
  keep_end_seq: false
  model_name: dinov2_vitb14_reg
  proj_model: DINOJSCC_Adapter
  proj_name: vitb_jscc_infonce
  proj_class: vitb_jscc_infonce
  resize_dim: 518
  type: DINOJSCC
  use_avg_text_token: false
  k: 36
  text_adapter_pretrain: weights/vitb_mlp_infonce.pth

[2025-10-21 17:01:15 default] (main.py 202): INFO Creating model:DINOJSCC/default
[2025-10-21 17:01:21 default] (main.py 221): INFO number of params: 649633 (0.6M)
[2025-10-21 17:01:21 default] (main.py 225): INFO GROUP_RANK = 0 | LOCAL_RANK = 0 | RANK = 0 | MASTER_ADDR = 127.0.0.1 | MASTER_PORT = 29500 | ROLE_RANK = 0 | LOCAL_WORLD_SIZE = 1 | WORLD_SIZE = 1 | ROLE_WORLD_SIZE = 1 | TORCHELASTIC_RESTART_COUNT = 0 | TORCHELASTIC_MAX_RESTARTS = 0 | TORCHELASTIC_RUN_ID = none
[2025-10-21 17:01:21 default] (main.py 232): INFO !!! Single-node setting :: skip fp16 compression hook
[2025-10-21 17:01:21 default] (main.py 450): INFO ### Validation dataset: cityscapes (Subset)
[2025-10-21 17:01:22 default] (dinotext_seg.py 43): INFO Building DINOTextSegInference with 19 classes, test_cfg=Config (path: None): {'mode': 'slide', 'stride': (224, 224), 'crop_size': (448, 448)}, with_bg=False, pamr=False, bg_thresh=0.4
[2025-10-21 17:03:08 default] (logging.py 102): INFO per class results:
[2025-10-21 17:03:08 default] (logging.py 102): INFO 
+---------------+-------+-------+
|     Class     |  IoU  |  Acc  |
+---------------+-------+-------+
|      road     | 15.72 | 16.17 |
|    sidewalk   | 12.41 |  97.0 |
|    building   | 58.74 | 69.29 |
|      wall     |  5.03 | 25.95 |
|     fence     | 29.93 | 37.63 |
|      pole     |  5.9  |  6.59 |
| traffic light |  9.14 | 86.67 |
|  traffic sign | 28.09 | 58.24 |
|   vegetation  |  2.01 |  2.01 |
|    terrain    |  1.1  |  3.46 |
|      sky      | 20.93 | 84.47 |
|     person    | 34.44 | 40.16 |
|     rider     | 15.52 | 62.67 |
|      car      | 67.85 | 72.64 |
|     truck     | 32.16 | 65.51 |
|      bus      | 27.23 | 88.63 |
|     train     |  0.15 |  0.17 |
|   motorcycle  | 23.49 | 83.93 |
|    bicycle    | 47.77 | 65.14 |
+---------------+-------+-------+
[2025-10-21 17:03:08 default] (logging.py 102): INFO Summary:
[2025-10-21 17:03:08 default] (logging.py 102): INFO 
+-------+-------+-------+
|  aAcc |  mIoU |  mAcc |
+-------+-------+-------+
| 37.35 | 23.03 | 50.86 |
+-------+-------+-------+
[2025-10-21 17:03:08 default] (main.py 454): INFO [cityscapes] mIoU of 500 test images: 23.03%
[2025-10-21 17:03:08 default] (main.py 241): INFO {'val/cityscapes_miou': 23.03, 'metrics': [{'aAcc': 0.3735, 'mIoU': 0.2303, 'mAcc': 0.5085999999999999, 'IoU.road': 0.15720000267028808, 'IoU.sidewalk': 0.12409999847412109, 'IoU.building': 0.587400016784668, 'IoU.wall': 0.050300002098083496, 'IoU.fence': 0.2993000030517578, 'IoU.pole': 0.05900000095367432, 'IoU.traffic light': 0.09140000343322754, 'IoU.traffic sign': 0.2809000015258789, 'IoU.vegetation': 0.020099999904632567, 'IoU.terrain': 0.01100000023841858, 'IoU.sky': 0.2093000030517578, 'IoU.person': 0.34439998626708984, 'IoU.rider': 0.15520000457763672, 'IoU.car': 0.678499984741211, 'IoU.truck': 0.3215999984741211, 'IoU.bus': 0.2722999954223633, 'IoU.train': 0.0015000000596046448, 'IoU.motorcycle': 0.23489999771118164, 'IoU.bicycle': 0.4777000045776367, 'Acc.road': 0.16170000076293944, 'Acc.sidewalk': 0.97, 'Acc.building': 0.6929000091552734, 'Acc.wall': 0.2595000076293945, 'Acc.fence': 0.3763000106811523, 'Acc.pole': 0.06590000152587891, 'Acc.traffic light': 0.8666999816894532, 'Acc.traffic sign': 0.582400016784668, 'Acc.vegetation': 0.020099999904632567, 'Acc.terrain': 0.03460000038146973, 'Acc.sky': 0.8447000122070313, 'Acc.person': 0.4015999984741211, 'Acc.rider': 0.6266999816894532, 'Acc.car': 0.7263999938964844, 'Acc.truck': 0.6551000213623047, 'Acc.bus': 0.8862999725341797, 'Acc.train': 0.0017000000178813935, 'Acc.motorcycle': 0.8393000030517578, 'Acc.bicycle': 0.6513999938964844}], 'val/avg_miou': 23.03}
[2025-10-21 17:03:08 default] (main.py 245): INFO  >> 23.03, 23.03
[2025-10-21 17:03:08 default] (main.py 246): INFO Experiment dir: output/eval
[2025-10-21 17:03:08 default] (main.py 145): INFO Saved results at segmentation_results/vitb_jscc_infonce.json
[2025-10-21 17:03:08 default] (main.py 607): INFO Experiment dir: output/eval
[2025-10-22 19:56:52 default] (main.py 589): INFO Full config saved to output/eval/config.json
[2025-10-22 19:56:52 default] (main.py 595): INFO Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
CUDA available: True
GPU 0: NVIDIA GeForce RTX 4090
CUDA_HOME: /usr/local/cuda-11.8
NVCC: Cuda compilation tools, release 11.8, V11.8.89
GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
PyTorch: 1.13.1+cu117
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

TorchVision: 0.14.1+cu117
OpenCV: 4.6.0
MMCV: 1.6.2
MMCV Compiler: GCC 9.4
MMCV CUDA Compiler: 11.8
------------------------------------------------------------

[2025-10-22 19:56:52 default] (main.py 597): INFO Git hash: ef51a59
[2025-10-22 19:56:52 default] (main.py 600): INFO evaluate:
  pamr: false
  bg_thresh: 0.4
  kp_w: 0.3
  pred_qual_path: null
  gt_qual_path: null
  eval_only: true
  template: sub_imagenet_template
  task:
  - cityscapes
  t_voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_voc12_20.py
  t_context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_context59.py
  voc: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12.py
  voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12_20.py
  context: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context.py
  context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context59.py
  coco_stuff: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/stuff.py
  coco_object: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/coco.py
  cityscapes: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/cityscapes.py
  ade20k: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/ade20k.py
  save_logits: null
  eval_freq: 5000
_base_: default.yml
data:
  batch_size: 256
  pin_memory: true
  num_workers: 0
  seed: ${train.seed}
  dataset:
    meta:
      gcc3m:
        type: img_txt_pair
        path: ./data/gcc3m
        prefix: gcc-train-{000000..00347}.tar
        length: 2881393
      gcc12m:
        type: img_txt_pair
        path: ./data/gcc12m
        prefix: cc-{000000..001175}.tar
        length: 11286526
    train:
    - gcc3m
    - gcc12m
  img_aug:
    deit_aug: true
    img_size: 224
    img_scale:
    - 0.08
    - 1.0
    interpolation: bilinear
    color_jitter: 0.4
    auto_augment: rand-m9-mstd0.5-inc1
    re_prob: 0.25
    re_mode: pixel
    re_count: 1
  text_aug: null
train:
  start_step: 0
  total_steps: 50000
  warmup_steps: 20000
  ust_steps: 0
  base_lr: 0.0016
  weight_decay: 0.05
  min_lr: 4.0e-05
  clip_grad: 5.0
  fp16: true
  fp16_comm: true
  seed: 42
  lr_scheduler:
    name: cosine
  optimizer:
    name: adamw
    eps: 1.0e-08
    betas:
    - 0.9
    - 0.999
checkpoint:
  resume: ''
  save_topk: 0
  save_all: false
model_name: default
output: output/eval
tag: default
print_freq: 20
seed: 42
wandb: false
model:
  clip_model_name: ViT-B/16
  keep_cls: false
  keep_end_seq: false
  model_name: dinov2_vitb14_reg
  proj_model: DINOJSCC_Adapter
  proj_name: vitb_jscc_infonce
  proj_class: vitb_jscc_infonce
  resize_dim: 518
  type: DINOJSCC
  use_avg_text_token: false
  k: 12
  text_adapter_pretrain: weights/vitb_mlp_infonce.pth

[2025-10-22 19:56:52 default] (main.py 202): INFO Creating model:DINOJSCC/default
[2025-10-22 19:56:58 default] (main.py 221): INFO number of params: 611521 (0.6M)
[2025-10-22 19:56:58 default] (main.py 225): INFO GROUP_RANK = 0 | LOCAL_RANK = 0 | RANK = 0 | MASTER_ADDR = 127.0.0.1 | MASTER_PORT = 29500 | ROLE_RANK = 0 | LOCAL_WORLD_SIZE = 1 | WORLD_SIZE = 1 | ROLE_WORLD_SIZE = 1 | TORCHELASTIC_RESTART_COUNT = 0 | TORCHELASTIC_MAX_RESTARTS = 0 | TORCHELASTIC_RUN_ID = none
[2025-10-22 19:56:58 default] (main.py 232): INFO !!! Single-node setting :: skip fp16 compression hook
[2025-10-22 19:56:58 default] (main.py 450): INFO ### Validation dataset: cityscapes (Subset)
[2025-10-22 19:56:59 default] (dinotext_seg.py 43): INFO Building DINOTextSegInference with 19 classes, test_cfg=Config (path: None): {'mode': 'slide', 'stride': (224, 224), 'crop_size': (448, 448)}, with_bg=False, pamr=False, bg_thresh=0.4
[2025-10-22 20:05:43 default] (logging.py 102): INFO per class results:
[2025-10-22 20:05:43 default] (logging.py 102): INFO 
+---------------+-------+-------+
|     Class     |  IoU  |  Acc  |
+---------------+-------+-------+
|      road     |  6.57 |  6.66 |
|    sidewalk   | 11.17 | 95.86 |
|    building   | 56.57 | 67.83 |
|      wall     |  3.2  | 16.99 |
|     fence     | 19.14 | 27.37 |
|      pole     |  1.31 |  1.36 |
| traffic light | 10.74 | 71.64 |
|  traffic sign | 29.67 | 56.72 |
|   vegetation  |  1.83 |  1.84 |
|    terrain    |  1.49 |  4.51 |
|      sky      | 19.96 |  83.9 |
|     person    | 28.16 | 32.97 |
|     rider     | 11.52 | 59.29 |
|      car      | 53.24 | 56.41 |
|     truck     | 10.02 | 46.79 |
|      bus      | 20.11 | 85.27 |
|     train     |  2.94 |  3.79 |
|   motorcycle  |  8.58 |  85.2 |
|    bicycle    | 24.35 | 29.98 |
+---------------+-------+-------+
[2025-10-22 20:05:43 default] (logging.py 102): INFO Summary:
[2025-10-22 20:05:43 default] (logging.py 102): INFO 
+------+-------+-------+
| aAcc |  mIoU |  mAcc |
+------+-------+-------+
| 31.6 | 16.87 | 43.92 |
+------+-------+-------+
[2025-10-22 20:05:43 default] (main.py 454): INFO [cityscapes] mIoU of 500 test images: 16.87%
[2025-10-22 20:05:43 default] (main.py 241): INFO {'val/cityscapes_miou': 16.87, 'metrics': [{'aAcc': 0.316, 'mIoU': 0.16870000000000002, 'mAcc': 0.43920000000000003, 'IoU.road': 0.06570000171661378, 'IoU.sidewalk': 0.11170000076293946, 'IoU.building': 0.5656999969482421, 'IoU.wall': 0.03200000047683716, 'IoU.fence': 0.19139999389648438, 'IoU.pole': 0.01309999942779541, 'IoU.traffic light': 0.10739999771118164, 'IoU.traffic sign': 0.29670000076293945, 'IoU.vegetation': 0.018300000429153442, 'IoU.terrain': 0.014900000095367431, 'IoU.sky': 0.19959999084472657, 'IoU.person': 0.2815999984741211, 'IoU.rider': 0.11520000457763672, 'IoU.car': 0.532400016784668, 'IoU.truck': 0.10020000457763673, 'IoU.bus': 0.20110000610351564, 'IoU.train': 0.02940000057220459, 'IoU.motorcycle': 0.08579999923706055, 'IoU.bicycle': 0.24350000381469727, 'Acc.road': 0.0665999984741211, 'Acc.sidewalk': 0.9586000061035156, 'Acc.building': 0.6783000183105469, 'Acc.wall': 0.16989999771118164, 'Acc.fence': 0.273700008392334, 'Acc.pole': 0.013600000143051148, 'Acc.traffic light': 0.7163999938964843, 'Acc.traffic sign': 0.5672000122070312, 'Acc.vegetation': 0.018400000333786012, 'Acc.terrain': 0.04510000228881836, 'Acc.sky': 0.8390000152587891, 'Acc.person': 0.32970001220703127, 'Acc.rider': 0.5929000091552734, 'Acc.car': 0.5640999984741211, 'Acc.truck': 0.4679000091552734, 'Acc.bus': 0.852699966430664, 'Acc.train': 0.03789999961853027, 'Acc.motorcycle': 0.8519999694824218, 'Acc.bicycle': 0.2997999954223633}], 'val/avg_miou': 16.87}
[2025-10-22 20:05:43 default] (main.py 245): INFO  >> 16.87, 16.87
[2025-10-22 20:05:43 default] (main.py 246): INFO Experiment dir: output/eval
[2025-10-22 20:05:43 default] (main.py 145): INFO Saved results at segmentation_results/vitb_jscc_infonce.json
[2025-10-22 20:05:44 default] (main.py 607): INFO Experiment dir: output/eval
[2025-10-22 20:14:40 default] (main.py 589): INFO Full config saved to output/eval/config.json
[2025-10-22 20:14:40 default] (main.py 595): INFO Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
CUDA available: True
GPU 0: NVIDIA GeForce RTX 4090
CUDA_HOME: /usr/local/cuda-11.8
NVCC: Cuda compilation tools, release 11.8, V11.8.89
GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
PyTorch: 1.13.1+cu117
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

TorchVision: 0.14.1+cu117
OpenCV: 4.6.0
MMCV: 1.6.2
MMCV Compiler: GCC 9.4
MMCV CUDA Compiler: 11.8
------------------------------------------------------------

[2025-10-22 20:14:40 default] (main.py 597): INFO Git hash: ef51a59
[2025-10-22 20:14:40 default] (main.py 600): INFO evaluate:
  pamr: false
  bg_thresh: 0.4
  kp_w: 0.3
  pred_qual_path: null
  gt_qual_path: null
  eval_only: true
  template: sub_imagenet_template
  task:
  - cityscapes
  t_voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_voc12_20.py
  t_context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_context59.py
  voc: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12.py
  voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12_20.py
  context: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context.py
  context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context59.py
  coco_stuff: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/stuff.py
  coco_object: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/coco.py
  cityscapes: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/cityscapes.py
  ade20k: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/ade20k.py
  save_logits: null
  eval_freq: 5000
_base_: default.yml
data:
  batch_size: 256
  pin_memory: true
  num_workers: 0
  seed: ${train.seed}
  dataset:
    meta:
      gcc3m:
        type: img_txt_pair
        path: ./data/gcc3m
        prefix: gcc-train-{000000..00347}.tar
        length: 2881393
      gcc12m:
        type: img_txt_pair
        path: ./data/gcc12m
        prefix: cc-{000000..001175}.tar
        length: 11286526
    train:
    - gcc3m
    - gcc12m
  img_aug:
    deit_aug: true
    img_size: 224
    img_scale:
    - 0.08
    - 1.0
    interpolation: bilinear
    color_jitter: 0.4
    auto_augment: rand-m9-mstd0.5-inc1
    re_prob: 0.25
    re_mode: pixel
    re_count: 1
  text_aug: null
train:
  start_step: 0
  total_steps: 50000
  warmup_steps: 20000
  ust_steps: 0
  base_lr: 0.0016
  weight_decay: 0.05
  min_lr: 4.0e-05
  clip_grad: 5.0
  fp16: true
  fp16_comm: true
  seed: 42
  lr_scheduler:
    name: cosine
  optimizer:
    name: adamw
    eps: 1.0e-08
    betas:
    - 0.9
    - 0.999
checkpoint:
  resume: ''
  save_topk: 0
  save_all: false
model_name: default
output: output/eval
tag: default
print_freq: 20
seed: 42
wandb: false
model:
  clip_model_name: ViT-B/16
  keep_cls: false
  keep_end_seq: false
  model_name: dinov2_vitb14_reg
  proj_model: DINOJSCC_Adapter
  proj_name: vitb_jscc_infonce
  proj_class: vitb_jscc_infonce
  resize_dim: 518
  type: DINOJSCC
  use_avg_text_token: false
  k: 12
  text_adapter_pretrain: weights/vitb_mlp_infonce.pth

[2025-10-22 20:14:40 default] (main.py 202): INFO Creating model:DINOJSCC/default
[2025-10-22 20:14:47 default] (main.py 221): INFO number of params: 611521 (0.6M)
[2025-10-22 20:14:47 default] (main.py 225): INFO GROUP_RANK = 0 | LOCAL_RANK = 0 | RANK = 0 | MASTER_ADDR = 127.0.0.1 | MASTER_PORT = 29500 | ROLE_RANK = 0 | LOCAL_WORLD_SIZE = 1 | WORLD_SIZE = 1 | ROLE_WORLD_SIZE = 1 | TORCHELASTIC_RESTART_COUNT = 0 | TORCHELASTIC_MAX_RESTARTS = 0 | TORCHELASTIC_RUN_ID = none
[2025-10-22 20:14:47 default] (main.py 232): INFO !!! Single-node setting :: skip fp16 compression hook
[2025-10-22 20:14:47 default] (main.py 450): INFO ### Validation dataset: cityscapes (Subset)
[2025-10-22 20:14:48 default] (dinotext_seg.py 43): INFO Building DINOTextSegInference with 19 classes, test_cfg=Config (path: None): {'mode': 'slide', 'stride': (224, 224), 'crop_size': (448, 448)}, with_bg=False, pamr=False, bg_thresh=0.4
[2025-10-22 20:23:46 default] (logging.py 102): INFO per class results:
[2025-10-22 20:23:46 default] (logging.py 102): INFO 
+---------------+-------+-------+
|     Class     |  IoU  |  Acc  |
+---------------+-------+-------+
|      road     |  5.98 |  6.05 |
|    sidewalk   | 11.23 | 97.21 |
|    building   | 59.78 |  72.3 |
|      wall     |  3.52 | 17.39 |
|     fence     | 22.72 | 30.52 |
|      pole     |  0.96 |  0.98 |
| traffic light | 11.04 | 78.14 |
|  traffic sign | 34.39 | 61.46 |
|   vegetation  |  1.81 |  1.81 |
|    terrain    |  0.93 |  2.55 |
|      sky      | 20.99 | 82.83 |
|     person    | 30.78 | 35.64 |
|     rider     |  13.6 | 59.66 |
|      car      | 60.25 | 64.56 |
|     truck     | 12.16 | 55.22 |
|      bus      | 26.53 | 86.96 |
|     train     |  1.17 |  1.29 |
|   motorcycle  |  8.71 | 87.27 |
|    bicycle    | 25.97 | 32.48 |
+---------------+-------+-------+
[2025-10-22 20:23:46 default] (logging.py 102): INFO Summary:
[2025-10-22 20:23:46 default] (logging.py 102): INFO 
+-------+-------+-------+
|  aAcc |  mIoU |  mAcc |
+-------+-------+-------+
| 33.05 | 18.55 | 46.02 |
+-------+-------+-------+
[2025-10-22 20:23:46 default] (main.py 454): INFO [cityscapes] mIoU of 500 test images: 18.55%
[2025-10-22 20:23:46 default] (main.py 241): INFO {'val/cityscapes_miou': 18.55, 'metrics': [{'aAcc': 0.33049999999999996, 'mIoU': 0.1855, 'mAcc': 0.46020000000000005, 'IoU.road': 0.059800000190734864, 'IoU.sidewalk': 0.11229999542236328, 'IoU.building': 0.5977999877929687, 'IoU.wall': 0.03519999980926514, 'IoU.fence': 0.22719999313354491, 'IoU.pole': 0.009599999785423278, 'IoU.traffic light': 0.11039999961853027, 'IoU.traffic sign': 0.3438999938964844, 'IoU.vegetation': 0.01809999942779541, 'IoU.terrain': 0.009300000071525573, 'IoU.sky': 0.20989999771118165, 'IoU.person': 0.3078000068664551, 'IoU.rider': 0.13600000381469726, 'IoU.car': 0.6025, 'IoU.truck': 0.12159999847412109, 'IoU.bus': 0.26530000686645505, 'IoU.train': 0.011699999570846558, 'IoU.motorcycle': 0.08710000038146973, 'IoU.bicycle': 0.2596999931335449, 'Acc.road': 0.06050000190734863, 'Acc.sidewalk': 0.9720999908447265, 'Acc.building': 0.7230000305175781, 'Acc.wall': 0.17389999389648436, 'Acc.fence': 0.30520000457763674, 'Acc.pole': 0.009800000190734863, 'Acc.traffic light': 0.7813999938964844, 'Acc.traffic sign': 0.6145999908447266, 'Acc.vegetation': 0.01809999942779541, 'Acc.terrain': 0.025499999523162842, 'Acc.sky': 0.8283000183105469, 'Acc.person': 0.35639999389648436, 'Acc.rider': 0.596599998474121, 'Acc.car': 0.6455999755859375, 'Acc.truck': 0.5522000122070313, 'Acc.bus': 0.8695999908447266, 'Acc.train': 0.012899999618530273, 'Acc.motorcycle': 0.872699966430664, 'Acc.bicycle': 0.32479999542236326}], 'val/avg_miou': 18.55}
[2025-10-22 20:23:46 default] (main.py 245): INFO  >> 18.55, 18.55
[2025-10-22 20:23:46 default] (main.py 246): INFO Experiment dir: output/eval
[2025-10-22 20:23:46 default] (main.py 145): INFO Saved results at segmentation_results/vitb_jscc_infonce.json
[2025-10-22 20:23:47 default] (main.py 607): INFO Experiment dir: output/eval
[2025-10-22 21:24:50 default] (main.py 589): INFO Full config saved to output/eval/config.json
[2025-10-22 21:24:50 default] (main.py 595): INFO Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
CUDA available: True
GPU 0,1,2,3: NVIDIA GeForce RTX 4090
CUDA_HOME: /usr/local/cuda-11.8
NVCC: Cuda compilation tools, release 11.8, V11.8.89
GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
PyTorch: 1.13.1+cu117
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

TorchVision: 0.14.1+cu117
OpenCV: 4.6.0
MMCV: 1.6.2
MMCV Compiler: GCC 9.4
MMCV CUDA Compiler: 11.8
------------------------------------------------------------

[2025-10-22 21:24:50 default] (main.py 597): INFO Git hash: ef51a59
[2025-10-22 21:24:50 default] (main.py 600): INFO evaluate:
  pamr: false
  bg_thresh: 0.4
  kp_w: 0.3
  pred_qual_path: null
  gt_qual_path: null
  eval_only: true
  template: sub_imagenet_template
  task:
  - cityscapes
  t_voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_voc12_20.py
  t_context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_context59.py
  voc: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12.py
  voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12_20.py
  context: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context.py
  context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context59.py
  coco_stuff: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/stuff.py
  coco_object: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/coco.py
  cityscapes: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/cityscapes.py
  ade20k: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/ade20k.py
  save_logits: null
  eval_freq: 5000
_base_: default.yml
data:
  batch_size: 256
  pin_memory: true
  num_workers: 0
  seed: ${train.seed}
  dataset:
    meta:
      gcc3m:
        type: img_txt_pair
        path: ./data/gcc3m
        prefix: gcc-train-{000000..00347}.tar
        length: 2881393
      gcc12m:
        type: img_txt_pair
        path: ./data/gcc12m
        prefix: cc-{000000..001175}.tar
        length: 11286526
    train:
    - gcc3m
    - gcc12m
  img_aug:
    deit_aug: true
    img_size: 224
    img_scale:
    - 0.08
    - 1.0
    interpolation: bilinear
    color_jitter: 0.4
    auto_augment: rand-m9-mstd0.5-inc1
    re_prob: 0.25
    re_mode: pixel
    re_count: 1
  text_aug: null
train:
  start_step: 0
  total_steps: 50000
  warmup_steps: 20000
  ust_steps: 0
  base_lr: 0.0016
  weight_decay: 0.05
  min_lr: 4.0e-05
  clip_grad: 5.0
  fp16: true
  fp16_comm: true
  seed: 42
  lr_scheduler:
    name: cosine
  optimizer:
    name: adamw
    eps: 1.0e-08
    betas:
    - 0.9
    - 0.999
checkpoint:
  resume: ''
  save_topk: 0
  save_all: false
model_name: default
output: output/eval
tag: default
print_freq: 20
seed: 42
wandb: false
model:
  clip_model_name: ViT-B/16
  keep_cls: false
  keep_end_seq: false
  model_name: dinov2_vitb14_reg
  proj_model: DINOJSCC_Adapter
  proj_name: vitb_jscc_infonce
  proj_class: vitb_jscc_infonce
  resize_dim: 518
  type: DINOJSCC
  use_avg_text_token: false
  k: 48
  text_adapter_pretrain: weights/vitb_mlp_infonce.pth

[2025-10-22 21:24:50 default] (main.py 202): INFO Creating model:DINOJSCC/default
[2025-10-22 21:24:56 default] (main.py 221): INFO number of params: 669121 (0.7M)
[2025-10-22 21:24:56 default] (main.py 225): INFO GROUP_RANK = 0 | LOCAL_RANK = 0 | RANK = 0 | MASTER_ADDR = 127.0.0.1 | MASTER_PORT = 29500 | ROLE_RANK = 0 | LOCAL_WORLD_SIZE = 1 | WORLD_SIZE = 1 | ROLE_WORLD_SIZE = 1 | TORCHELASTIC_RESTART_COUNT = 0 | TORCHELASTIC_MAX_RESTARTS = 0 | TORCHELASTIC_RUN_ID = none
[2025-10-22 21:24:56 default] (main.py 232): INFO !!! Single-node setting :: skip fp16 compression hook
[2025-10-22 21:24:56 default] (main.py 450): INFO ### Validation dataset: cityscapes (Subset)
[2025-10-22 21:24:57 default] (dinotext_seg.py 43): INFO Building DINOTextSegInference with 19 classes, test_cfg=Config (path: None): {'mode': 'slide', 'stride': (224, 224), 'crop_size': (448, 448)}, with_bg=False, pamr=False, bg_thresh=0.4
[2025-10-22 21:26:42 default] (main.py 589): INFO Full config saved to output/eval/config.json
[2025-10-22 21:26:42 default] (main.py 595): INFO Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.10.16 (main, Dec 11 2024, 16:24:50) [GCC 11.2.0]
CUDA available: True
GPU 0: NVIDIA GeForce RTX 4090
CUDA_HOME: /usr/local/cuda-11.8
NVCC: Cuda compilation tools, release 11.8, V11.8.89
GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
PyTorch: 1.13.1+cu117
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

TorchVision: 0.14.1+cu117
OpenCV: 4.6.0
MMCV: 1.6.2
MMCV Compiler: GCC 9.4
MMCV CUDA Compiler: 11.8
------------------------------------------------------------

[2025-10-22 21:26:42 default] (main.py 597): INFO Git hash: ef51a59
[2025-10-22 21:26:42 default] (main.py 600): INFO evaluate:
  pamr: false
  bg_thresh: 0.4
  kp_w: 0.3
  pred_qual_path: null
  gt_qual_path: null
  eval_only: true
  template: sub_imagenet_template
  task:
  - cityscapes
  t_voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_voc12_20.py
  t_context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/t_pascal_context59.py
  voc: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12.py
  voc20: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_voc12_20.py
  context: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context.py
  context59: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/pascal_context59.py
  coco_stuff: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/stuff.py
  coco_object: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/coco.py
  cityscapes: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/cityscapes.py
  ade20k: src/open_vocabulary_segmentation/segmentation/configs/_base_/datasets/ade20k.py
  save_logits: null
  eval_freq: 5000
_base_: default.yml
data:
  batch_size: 256
  pin_memory: true
  num_workers: 0
  seed: ${train.seed}
  dataset:
    meta:
      gcc3m:
        type: img_txt_pair
        path: ./data/gcc3m
        prefix: gcc-train-{000000..00347}.tar
        length: 2881393
      gcc12m:
        type: img_txt_pair
        path: ./data/gcc12m
        prefix: cc-{000000..001175}.tar
        length: 11286526
    train:
    - gcc3m
    - gcc12m
  img_aug:
    deit_aug: true
    img_size: 224
    img_scale:
    - 0.08
    - 1.0
    interpolation: bilinear
    color_jitter: 0.4
    auto_augment: rand-m9-mstd0.5-inc1
    re_prob: 0.25
    re_mode: pixel
    re_count: 1
  text_aug: null
train:
  start_step: 0
  total_steps: 50000
  warmup_steps: 20000
  ust_steps: 0
  base_lr: 0.0016
  weight_decay: 0.05
  min_lr: 4.0e-05
  clip_grad: 5.0
  fp16: true
  fp16_comm: true
  seed: 42
  lr_scheduler:
    name: cosine
  optimizer:
    name: adamw
    eps: 1.0e-08
    betas:
    - 0.9
    - 0.999
checkpoint:
  resume: ''
  save_topk: 0
  save_all: false
model_name: default
output: output/eval
tag: default
print_freq: 20
seed: 42
wandb: false
model:
  clip_model_name: ViT-B/16
  keep_cls: false
  keep_end_seq: false
  model_name: dinov2_vitb14_reg
  proj_model: DINOJSCC_Adapter
  proj_name: vitb_jscc_infonce
  proj_class: vitb_jscc_infonce
  resize_dim: 518
  type: DINOJSCC
  use_avg_text_token: false
  k: 48
  text_adapter_pretrain: weights/vitb_mlp_infonce.pth

[2025-10-22 21:26:42 default] (main.py 202): INFO Creating model:DINOJSCC/default
[2025-10-22 21:26:49 default] (main.py 221): INFO number of params: 669121 (0.7M)
[2025-10-22 21:26:49 default] (main.py 225): INFO GROUP_RANK = 0 | LOCAL_RANK = 0 | RANK = 0 | MASTER_ADDR = 127.0.0.1 | MASTER_PORT = 29500 | ROLE_RANK = 0 | LOCAL_WORLD_SIZE = 1 | WORLD_SIZE = 1 | ROLE_WORLD_SIZE = 1 | TORCHELASTIC_RESTART_COUNT = 0 | TORCHELASTIC_MAX_RESTARTS = 0 | TORCHELASTIC_RUN_ID = none
[2025-10-22 21:26:49 default] (main.py 232): INFO !!! Single-node setting :: skip fp16 compression hook
[2025-10-22 21:26:49 default] (main.py 450): INFO ### Validation dataset: cityscapes (Subset)
[2025-10-22 21:26:50 default] (dinotext_seg.py 43): INFO Building DINOTextSegInference with 19 classes, test_cfg=Config (path: None): {'mode': 'slide', 'stride': (224, 224), 'crop_size': (448, 448)}, with_bg=False, pamr=False, bg_thresh=0.4
